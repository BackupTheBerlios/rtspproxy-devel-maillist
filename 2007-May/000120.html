<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Rtspproxy-devel] r437 - in trunk: . JainSDP RTSPProxy-App RTSPProxy-App/src/main/java/rtspproxy RTSPProxy-App/src/main/java/rtspproxy/filter/accounting RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress RTSPProxy-Core RTSPProxy-Core/src/main/java/rtspproxy RTSPProxy-Core/src/main/java/rtspproxy/config RTSPProxy-Core/src/main/java/rtspproxy/filter RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking RTSPProxy-Core/src/main/java/rtspproxy/jmx RTSPProxy-Core/src/main/java/rtspproxy/lib/number RTSPProxy-Core/src/main/java/rtspproxy/proxy RTSPProxy-Core/src/main/java/rtspproxy/rdt RTSPProxy-Core/src/main/java/rtspproxy/rtp/range RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test/java/rtspproxy/lib RTSPProxy-Core/src/test/java/rtspproxy/lib/number RTSPProxy-Core/src/test/java/rtspproxy/rdt RTSPProxy-Core/src/test/java/rtspproxy/rtp RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test! /java/rtspproxy/rtsp RTSPProxy-OSGi
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/rtspproxy-devel/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:rtspproxy-devel%40lists.berlios.de?Subject=Re%3A%20%5BRtspproxy-devel%5D%20r437%20-%20in%20trunk%3A%20.%20JainSDP%20RTSPProxy-App%0A%20RTSPProxy-App/src/main/java/rtspproxy%0A%20RTSPProxy-App/src/main/java/rtspproxy/filter/accounting%0A%20RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress%20RTSPProxy-Core%0A%20RTSPProxy-Core/src/main/java/rtspproxy%0A%20RTSPProxy-Core/src/main/java/rtspproxy/config%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking%0A%20RTSPProxy-Core/src/main/java/rtspproxy/jmx%0A%20RTSPProxy-Core/src/main/java/rtspproxy/lib/number%0A%20RTSPProxy-Core/src/main/java/rtspproxy/proxy%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rdt%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rtp/range%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp%0A%20RTSPProxy-Core/src/test/java/rtspproxy/lib%0A%20RTSPProxy-Core/src/test/java/rtspproxy/lib/number%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rdt%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rtp%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp%20RTSPProxy-Core/src/test%21%0A%20/java/rtspproxy/rtsp%20RTSPProxy-OSGi&In-Reply-To=%3C200705021633.l42GXvDA013083%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Rtspproxy-devel] r437 - in trunk: . JainSDP RTSPProxy-App RTSPProxy-App/src/main/java/rtspproxy RTSPProxy-App/src/main/java/rtspproxy/filter/accounting RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress RTSPProxy-Core RTSPProxy-Core/src/main/java/rtspproxy RTSPProxy-Core/src/main/java/rtspproxy/config RTSPProxy-Core/src/main/java/rtspproxy/filter RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking RTSPProxy-Core/src/main/java/rtspproxy/jmx RTSPProxy-Core/src/main/java/rtspproxy/lib/number RTSPProxy-Core/src/main/java/rtspproxy/proxy RTSPProxy-Core/src/main/java/rtspproxy/rdt RTSPProxy-Core/src/main/java/rtspproxy/rtp/range RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test/java/rtspproxy/lib RTSPProxy-Core/src/test/java/rtspproxy/lib/number RTSPProxy-Core/src/test/java/rtspproxy/rdt RTSPProxy-Core/src/test/java/rtspproxy/rtp RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test! /java/rtspproxy/rtsp RTSPProxy-OSGi</H1>
    <B>merlimat at mail.berlios.de</B> 
    <A HREF="mailto:rtspproxy-devel%40lists.berlios.de?Subject=Re%3A%20%5BRtspproxy-devel%5D%20r437%20-%20in%20trunk%3A%20.%20JainSDP%20RTSPProxy-App%0A%20RTSPProxy-App/src/main/java/rtspproxy%0A%20RTSPProxy-App/src/main/java/rtspproxy/filter/accounting%0A%20RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress%20RTSPProxy-Core%0A%20RTSPProxy-Core/src/main/java/rtspproxy%0A%20RTSPProxy-Core/src/main/java/rtspproxy/config%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication%0A%20RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking%0A%20RTSPProxy-Core/src/main/java/rtspproxy/jmx%0A%20RTSPProxy-Core/src/main/java/rtspproxy/lib/number%0A%20RTSPProxy-Core/src/main/java/rtspproxy/proxy%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rdt%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rtp/range%0A%20RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp%0A%20RTSPProxy-Core/src/test/java/rtspproxy/lib%0A%20RTSPProxy-Core/src/test/java/rtspproxy/lib/number%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rdt%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rtp%0A%20RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp%20RTSPProxy-Core/src/test%21%0A%20/java/rtspproxy/rtsp%20RTSPProxy-OSGi&In-Reply-To=%3C200705021633.l42GXvDA013083%40sheep.berlios.de%3E"
       TITLE="[Rtspproxy-devel] r437 - in trunk: . JainSDP RTSPProxy-App RTSPProxy-App/src/main/java/rtspproxy RTSPProxy-App/src/main/java/rtspproxy/filter/accounting RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress RTSPProxy-Core RTSPProxy-Core/src/main/java/rtspproxy RTSPProxy-Core/src/main/java/rtspproxy/config RTSPProxy-Core/src/main/java/rtspproxy/filter RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking RTSPProxy-Core/src/main/java/rtspproxy/jmx RTSPProxy-Core/src/main/java/rtspproxy/lib/number RTSPProxy-Core/src/main/java/rtspproxy/proxy RTSPProxy-Core/src/main/java/rtspproxy/rdt RTSPProxy-Core/src/main/java/rtspproxy/rtp/range RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test/java/rtspproxy/lib RTSPProxy-Core/src/test/java/rtspproxy/lib/number RTSPProxy-Core/src/test/java/rtspproxy/rdt RTSPProxy-Core/src/test/java/rtspproxy/rtp RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp RTSPProxy-Core/src/test! /java/rtspproxy/rtsp RTSPProxy-OSGi">merlimat at mail.berlios.de
       </A><BR>
    <I>Wed May  2 18:33:57 CEST 2007</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: merlimat
Date: 2007-05-02 18:31:26 +0200 (Wed, 02 May 2007)
New Revision: 437

Added:
   trunk/JainSDP/LICENSE.txt
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/IProxyServiceRegistry.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/IReactor.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/IFilterRegistry.java
   trunk/RTSPProxy-Core/testng.xml
   trunk/generateEclipseProjects.sh
Removed:
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpRtcpFilterChainBuilder.java
Modified:
   trunk/RTSPProxy-App/
   trunk/RTSPProxy-App/pom.xml
   trunk/RTSPProxy-App/src/main/java/rtspproxy/Main.java
   trunk/RTSPProxy-App/src/main/java/rtspproxy/filter/accounting/SimpleAccountingProvider.java
   trunk/RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress/PlainTextIpAddressProviderTest.java
   trunk/RTSPProxy-Core/pom.xml
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyService.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyServiceRegistry.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/Reactor.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/ShutdownHandler.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/config/Config.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterBase.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterRegistry.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/RtspFilters.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication/AuthenticationFilter.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking/RdtSessionTrackingFilter.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/JmxAgent.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/ProxySessionList.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedByte.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedInt.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedShort.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/proxy/ProxyHandler.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/rdt/RdtProtocolDecoder.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpServerSessionFactory.java
   trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp/RtcpPacket.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/NptTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedByteTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedIntTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedLongTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedShortTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/BufferUtils.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtAckPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtDataPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtLatencyRepostPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttRequestPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttResponsePacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtStreamEndPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/RtpPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp/RtcpPacketTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportListTest.java
   trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportTest.java
   trunk/RTSPProxy-OSGi/
   trunk/pom.xml
Log:
Big update, mostly infrastructure, tests, introduced guice.


Copied: trunk/JainSDP/LICENSE.txt (from rev 426, trunk/LICENSE.txt)


Property changes on: trunk/RTSPProxy-App
___________________________________________________________________
Name: svn:ignore
   - 
target

   + target
log


Modified: trunk/RTSPProxy-App/pom.xml
===================================================================
--- trunk/RTSPProxy-App/pom.xml	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-App/pom.xml	2007-05-02 16:31:26 UTC (rev 437)
@@ -24,7 +24,19 @@
 			&lt;groupId&gt;net.merlimat&lt;/groupId&gt;
 			&lt;artifactId&gt;RTSPProxy-Core&lt;/artifactId&gt;
 			&lt;version&gt;3.0-ALPHA5-SNAPSHOT&lt;/version&gt;
-		&lt;/dependency&gt;		
+		&lt;/dependency&gt;
+		
+		&lt;dependency&gt;
+			&lt;groupId&gt;org.slf4j&lt;/groupId&gt;
+			&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
+			&lt;version&gt;1.3.1&lt;/version&gt;
+		&lt;/dependency&gt;
+		
+		&lt;dependency&gt;
+			&lt;groupId&gt;log4j&lt;/groupId&gt;
+			&lt;artifactId&gt;log4j&lt;/artifactId&gt;
+			&lt;version&gt;1.2.14&lt;/version&gt;
+		&lt;/dependency&gt;	
 	&lt;/dependencies&gt;
 
 

Modified: trunk/RTSPProxy-App/src/main/java/rtspproxy/Main.java
===================================================================
--- trunk/RTSPProxy-App/src/main/java/rtspproxy/Main.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-App/src/main/java/rtspproxy/Main.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -30,6 +30,9 @@
 import rtspproxy.config.XMLConfigReader;
 import rtspproxy.lib.Exceptions;
 
+import com.google.inject.Guice;
+import com.google.inject.Injector;
+
 /**
  * 
  */
@@ -40,6 +43,9 @@
 
     public static void main( String[] args )
     {
+        Injector injector = Guice.createInjector();
+        IReactor reactor = injector.getInstance( IReactor.class );
+        
         // Configure the logger with default settings
         // useful to track pre-config file errors
         BasicConfigurator.configure();
@@ -112,11 +118,11 @@
                 log.debug( Config.debugParameters() );
             }
 
-            Reactor.setStandalone( true );
-            Reactor.start();
+            reactor.setStandalone( true );
+            reactor.start();
 
         } catch ( Exception e ) {
-            log.fatal( &quot;Exception in the reactor: &quot; + e );
+            log.fatal( &quot;Exception in the reactor: &quot;, e );
             Exceptions.logStackTrace( e );
             System.exit( -1 );
         }

Modified: trunk/RTSPProxy-App/src/main/java/rtspproxy/filter/accounting/SimpleAccountingProvider.java
===================================================================
--- trunk/RTSPProxy-App/src/main/java/rtspproxy/filter/accounting/SimpleAccountingProvider.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-App/src/main/java/rtspproxy/filter/accounting/SimpleAccountingProvider.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -27,8 +27,6 @@
 
     private static Logger log = LoggerFactory.getLogger( SimpleAccountingProvider.class );
 
-    private static final String requestMessageATTR = SimpleAccountingProvider.class.getName() + &quot;requestATTR&quot;;
-
     // This is not static since it's a separate log
     private Logger accessLog = null;
 

Modified: trunk/RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress/PlainTextIpAddressProviderTest.java
===================================================================
--- trunk/RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress/PlainTextIpAddressProviderTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-App/src/test/java/rtspproxy/filter/ipaddress/PlainTextIpAddressProviderTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,18 +17,17 @@
  */
 package rtspproxy.filter.ipaddress;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Test;
 
 /**
  * @author Matteo Merli
  */
-public class PlainTextIpAddressProviderTest extends TestCase
+public class PlainTextIpAddressProviderTest
 {
 	// TODO: Rewrite this test using the xml based configuration
 
-	private static final String CRLF = &quot;\r\n&quot;;
-
-	public void test1() throws Exception
+	@Test
+    public void test1() throws Exception
 	{
 	/*
 		// prepare
@@ -47,7 +46,8 @@
 	*/
 	}
 	
-	public void test2() throws Exception
+	@Test
+    public void test2() throws Exception
 	{
 	/*
 		// prepare

Modified: trunk/RTSPProxy-Core/pom.xml
===================================================================
--- trunk/RTSPProxy-Core/pom.xml	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/pom.xml	2007-05-02 16:31:26 UTC (rev 437)
@@ -20,7 +20,7 @@
 	&lt;artifactId&gt;RTSPProxy-Core&lt;/artifactId&gt;	
 
 	&lt;build&gt;
-		&lt;defaultGoal&gt;assembly:directory&lt;/defaultGoal&gt;
+		&lt;defaultGoal&gt;package&lt;/defaultGoal&gt;
 
 		&lt;resources&gt;
 			&lt;resource&gt;

Added: trunk/RTSPProxy-Core/src/main/java/rtspproxy/IProxyServiceRegistry.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/IProxyServiceRegistry.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/IProxyServiceRegistry.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -0,0 +1,108 @@
+package rtspproxy;
+
+import java.io.IOException;
+import java.net.InetSocketAddress;
+import java.util.Set;
+import java.util.concurrent.Executor;
+
+import org.apache.mina.common.IoAcceptor;
+import org.apache.mina.common.IoFilterChainBuilder;
+import org.apache.mina.common.IoHandler;
+
+import com.google.inject.ImplementedBy;
+
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at ImplementedBy</A>(ProxyServiceRegistry.class)
+public interface IProxyServiceRegistry
+{
+    /**
+     * Bind a Service to a local address and specify the IoHandler that will
+     * manage ingoing and outgoing messages.
+     * 
+     * @param service
+     *            the ProxyService
+     * @param ioHandler
+     *            the IoHandler that will handle the messages
+     * @param address
+     *            the local address to bind on
+     * @throws IOException
+     */
+    public void bind( ProxyService service, IoHandler ioHandler,
+            InetSocketAddress address ) throws IOException;
+    
+    /**
+     * Bind a Service to a local address and specify the IoHandler that will
+     * manage ingoing and outgoing messages.
+     * &lt;p&gt;
+     * In addition it should be specified an IoFilterChainBuilder. This builder
+     * will be associated with the IoAcceptor itself (which is unique per
+     * ProxyService) and not for every IoSession created.
+     * 
+     * @param service
+     *            the ProxyService
+     * @param ioHandler
+     *            the IoHandler that will handle the messages
+     * @param address
+     *            the local address to bind on
+     * @param filterChainBuilder
+     *            the IoFilterChainBuilder instance
+     * @throws IOException
+     */
+    public void bind( ProxyService service, IoHandler ioHandler,
+            InetSocketAddress address, IoFilterChainBuilder filterChainBuilder )
+            throws IOException;
+    
+    public void unbind( ProxyService service ) throws Exception;
+    
+    /**
+     * Unbind the service from all of its bound addresses.
+     * 
+     * @param service
+     *            the ProxyService
+     * @throws Exception
+     */
+    public void unbind( ProxyService service, boolean stopService )
+            throws Exception;
+    
+    /**
+     * Unbind all the services registered in the ProxyServiceRegistry, from all
+     * of they bound addresses.
+     * 
+     * @throws Exception
+     */
+    public void unbindAll() throws Exception;
+    
+    /**
+     * @return a Set containing all the registered services.
+     */
+    public Set&lt;ProxyService&gt; getAllServices();
+    
+    /**
+     * Return the instance of a ProxyService.
+     * 
+     * @param name
+     *            the name of the ProxyService
+     * @return the instance of the ProxyService
+     */
+    public ProxyService getService( String name );
+    
+    /**
+     * Returns a reference to the IoAcceptor used by the specified ProxyService.
+     * 
+     * @param serviceName
+     *            the name of the ProxyService
+     * @return the IoAcceptor associated with the service or null if the
+     *         serviceName is invalid
+     */
+    public IoAcceptor getAcceptor( String serviceName );
+    
+    /**
+     * Returns a reference to the IoAcceptor used by the specified ProxyService.
+     * 
+     * @param service
+     *            the ProxyService
+     * @return the IoAcceptor associated with the service
+     */
+    public IoAcceptor getAcceptor( ProxyService service );
+    
+    public Executor getExecutor();
+}
\ No newline at end of file


Property changes on: trunk/RTSPProxy-Core/src/main/java/rtspproxy/IProxyServiceRegistry.java
___________________________________________________________________
Name: svn:keywords
   + Id URL Rev

Added: trunk/RTSPProxy-Core/src/main/java/rtspproxy/IReactor.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/IReactor.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/IReactor.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -0,0 +1,23 @@
+package rtspproxy;
+
+import com.google.inject.ImplementedBy;
+
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at ImplementedBy</A>(Reactor.class)
+public interface IReactor
+{
+    
+    public void setStandalone( boolean standalone );
+    
+    /**
+     * Constructor. Creates a new Reactor and starts it. The reactor relies on
+     * configuration info that has to be provided &lt;b&gt;before&lt;/b&gt; starting the
+     * reactor.
+     * 
+     * @exception Exception
+     *                reactor startup failed.
+     */
+    public void start() throws Exception;
+    
+    public void stop();
+    
+}
\ No newline at end of file


Property changes on: trunk/RTSPProxy-Core/src/main/java/rtspproxy/IReactor.java
___________________________________________________________________
Name: svn:keywords
   + Id URL Rev

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyService.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyService.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyService.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -34,6 +34,10 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import com.google.inject.Guice;
+import com.google.inject.Inject;
+import com.google.inject.Injector;
+
 import rtspproxy.config.Parameter;
 import rtspproxy.lib.Exceptions;
 import rtspproxy.lib.NetworkInterface;
@@ -47,26 +51,36 @@
  */
 public abstract class ProxyService extends Singleton implements Observer
 {
-
+    
     private static Logger log = LoggerFactory.getLogger( ProxyService.class );
-
+    
     /**
      * Main Socket address used by the service. It can be bound on several
      * different addresses and network interfaces, but it MUST have a default
      * address to be communicated to third parties.
      */
     private InetSocketAddress socketAddress = null;
-
+    
     /**
      * Flag used to keep track of the service status.
      */
     private volatile boolean isRunning = false;
-
+    
     /**
      * Service hook name.
      */
     protected static final String SERVICE = ProxyService.class.getName();
-
+    
+    @Inject
+    private IProxyServiceRegistry serviceRegistry;
+    
+    public ProxyService()
+    {
+        // XXX: Remove the injector!!
+        Injector injector = Guice.createInjector();
+        serviceRegistry = injector.getInstance( IProxyServiceRegistry.class );
+    }
+    
     /**
      * Starts the service.
      * 
@@ -74,61 +88,73 @@
      */
     public void start() throws Exception
     {
-        if ( isRunning ) {
+        if ( isRunning )
+        {
             log.warn( getName() + &quot; is already running.&quot; );
             return;
         }
-
+        
         int port = getBindPort();
-
+        
         log.debug( &quot;Service Bind port: {}&quot;, port );
-
-        try {
-            if ( getNetworkAddress() != null ) {
-                socketAddress = new InetSocketAddress( getNetworkAddress(), port );
+        
+        try
+        {
+            if ( getNetworkAddress() != null )
+            {
+                socketAddress =
+                        new InetSocketAddress( getNetworkAddress(), port );
                 log.debug( &quot;binding to specific address: {}&quot;, socketAddress );
-
-                Reactor.getRegistry().bind( this, getIoHandler(), socketAddress,
-                        getFilterChainBuilder() );
-
-            } else {
+                
+                serviceRegistry.bind( this, getIoHandler(), socketAddress,
+                                      getFilterChainBuilder() );
+                
+            }
+            else
+            {
                 String netInterface = getNetworkInterface();
-
-                Set&lt;InetAddress&gt; addressSet = NetworkInterface
-                        .getInterfaceAddresses( netInterface );
-
-                log.debug( &quot;Network Interface: {} - Addresses: {}&quot;, netInterface,
-                        addressSet );
-                if ( addressSet == null ) {
+                
+                Set&lt;InetAddress&gt; addressSet =
+                        NetworkInterface.getInterfaceAddresses( netInterface );
+                
+                log.debug( &quot;Network Interface: {} - Addresses: {}&quot;,
+                           netInterface, addressSet );
+                if ( addressSet == null )
+                {
                     throw new RuntimeException( &quot;Invalid Network interface: &quot;
                             + netInterface );
                 }
-
-                for ( InetAddress inetAddress : addressSet ) {
+                
+                for ( InetAddress inetAddress : addressSet )
+                {
                     // Bind to all addresses
-
+                    
                     log.debug( &quot;binding to address from set: {}&quot;, socketAddress );
                     socketAddress = new InetSocketAddress( inetAddress, port );
-
-                    Reactor.getRegistry().bind( this, getIoHandler(), socketAddress,
-                            getFilterChainBuilder() );
-
+                    
+                    serviceRegistry.bind( this, getIoHandler(),
+                                                socketAddress,
+                                                getFilterChainBuilder() );
+                    
                 }
-
+                
                 // Choose a bind address
-                InetAddress inetAddress = NetworkInterface.getBindAddress( addressSet );
+                InetAddress inetAddress =
+                        NetworkInterface.getBindAddress( addressSet );
                 socketAddress = new InetSocketAddress( inetAddress, port );
-
+                
             }
-        } catch ( IOException e ) {
-            log.error( &quot;Can't start {} ({}): &quot; + e.getMessage(), getName(), socketAddress  );
+        } catch ( IOException e )
+        {
+            log.error( &quot;Can't start {} ({}): &quot; + e.getMessage(), getName(),
+                       socketAddress );
             throw e;
         }
         log.info( &quot;{} Started - Listening on: {}&quot;, getName(), socketAddress );
-
+        
         isRunning = true;
     }
-
+    
     /**
      * Stops the service
      * 
@@ -136,21 +162,24 @@
      */
     public void stop() throws Exception
     {
-        if ( !isRunning ) {
+        if ( !isRunning )
+        {
             log.warn( getName() + &quot; is not running.&quot; );
             return;
         }
-
-        try {
-            Reactor.getRegistry().unbind( this, false );
-        } catch ( Exception e ) {
+        
+        try
+        {
+            serviceRegistry.unbind( this, false );
+        } catch ( Exception e )
+        {
             log.debug( &quot;Exception unbinding service: {}&quot;, e.getMessage() );
         }
-
+        
         log.info( getName() + &quot; Stopped&quot; );
         isRunning = false;
     }
-
+    
     /**
      * Restart the service.
      * 
@@ -159,14 +188,12 @@
     public void restart() throws Exception
     {
         log.info( &quot;Restarting {}&quot;, getName() );
-        if ( isRunning )
-            stop();
-        else
-            log.warn( getName() + &quot; is not running.&quot; );
-
+        if ( isRunning ) stop();
+        else log.warn( getName() + &quot; is not running.&quot; );
+        
         start();
     }
-
+    
     /**
      * @return true if the server is running
      */
@@ -174,18 +201,18 @@
     {
         return isRunning;
     }
-
+    
     /**
      * @return the transport type used by this service
      */
     public abstract TransportType getTransportType();
-
+    
     /**
      * @return an instance to the IoHandler object that will receive all the
      *         messages.
      */
     public abstract IoHandler getIoHandler();
-
+    
     /**
      * @return the filter chain builder to be be used by the IoAcceptor
      *         associated with the service.
@@ -195,14 +222,14 @@
         // By default there's no filter chain
         return IoFilterChainBuilder.NOOP;
     }
-
+    
     /**
      * Return the name of the service.
      * 
      * @return the human readable name
      */
     public abstract String getName();
-
+    
     /**
      * Get the network interface to bind to. This is only used if there is no
      * more specific IP address configured.
@@ -211,31 +238,31 @@
      *         the configuratio registry (Config).
      */
     public abstract String getNetworkInterface();
-
+    
     /**
      * @return the network address to bind this service on, as it appears in the
      *         configuration registry (Config). If null, the network interface
      *         configuration parameter is used.
      */
     public abstract String getNetworkAddress();
-
+    
     /**
      * @return the port to bind on, as it appear in the configuration registry.
      */
     public abstract int getBindPort();
-
+    
     /**
      * @return the Parameter associated with the network interface used by the
      *         service.
      */
     public abstract Parameter getNetworkInterfaceParameter();
-
+    
     /**
      * @return the Parameter associated with the port number used by the
      *         service.
      */
     public abstract Parameter getPortParameter();
-
+    
     /**
      * @return the main IP address where the service is bound.
      */
@@ -243,7 +270,7 @@
     {
         return socketAddress.getAddress();
     }
-
+    
     /**
      * @return the main TCP or UDP port where the service is bound.
      */
@@ -251,7 +278,7 @@
     {
         return socketAddress.getPort();
     }
-
+    
     /**
      * @return the TCP or UDP address (IP+port) where the service is bound.
      */
@@ -259,7 +286,7 @@
     {
         return socketAddress;
     }
-
+    
     /**
      * Creates a new connection-less IoSession to a remote address. This is only
      * used to create UDP session.
@@ -271,20 +298,20 @@
     public synchronized IoSession newSession( SocketAddress remoteAddress )
     {
         IoSession session = null;
-        IoAcceptor acceptor = Reactor.getRegistry().getAcceptor( this );
-
+        IoAcceptor acceptor = serviceRegistry.getAcceptor( this );
+        
         // TODO: ConnectionlessSessionTracker
         // if(acceptor instanceof ConnectionlessSessionTracker)
         // session =
         // ((ConnectionlessSessionTracker)acceptor).getSession(socketAddress,
         // remoteAddress);
-
+        
         if ( session == null )
             session = acceptor.newSession( remoteAddress, socketAddress );
-
+        
         return session;
     }
-
+    
     /**
      * Update the ProxyService state. A proxy service will likely subscribe to
      * some parameter changes notifications. When a change is notified the
@@ -304,10 +331,12 @@
     {
         if ( !(o instanceof Parameter) )
             throw new IllegalArgumentException( &quot;Only observe parameters&quot; );
-
-        try {
+        
+        try
+        {
             restart();
-        } catch ( Exception e ) {
+        } catch ( Exception e )
+        {
             log.error( &quot;Error restarting {}&quot;, getName() );
             Exceptions.logStackTrace( e );
             throw new RuntimeException( e );

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyServiceRegistry.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyServiceRegistry.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/ProxyServiceRegistry.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -28,7 +28,6 @@
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentMap;
 import java.util.concurrent.Executor;
-import java.util.concurrent.ExecutorService;
 import java.util.concurrent.Executors;
 
 import org.apache.mina.common.IoAcceptor;
@@ -37,7 +36,6 @@
 import org.apache.mina.common.IoServiceConfig;
 import org.apache.mina.common.IoSession;
 import org.apache.mina.common.TransportType;
-import org.apache.mina.filter.executor.ExecutorExecutor;
 import org.apache.mina.transport.socket.nio.DatagramAcceptor;
 import org.apache.mina.transport.socket.nio.DatagramAcceptorConfig;
 import org.apache.mina.transport.socket.nio.DatagramSessionConfig;
@@ -48,15 +46,17 @@
 
 import rtspproxy.config.Config;
 import rtspproxy.config.Parameter;
-import rtspproxy.lib.Singleton;
 
+import com.google.inject.Singleton;
+
 /**
  * Custom implementation of the ServiceRegistry interface. Creates an acceptor
  * for every service.
  * 
  * @author Matteo Merli
  */
-public final class ProxyServiceRegistry extends Singleton implements Observer
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at Singleton</A>
+public final class ProxyServiceRegistry implements Observer, IProxyServiceRegistry
 {
     
     private static Logger log = LoggerFactory
@@ -72,21 +72,20 @@
     
     private DatagramAcceptor datagramAcceptor = null;
     
-    private ExecutorService executor = Executors.newCachedThreadPool();
+    private Executor executor = Executors.newCachedThreadPool();
     
     /**
      * Construct a new ProxyServiceRegistry. This class is a Singleton, so there
      * can be only one instance.
      */
-    public ProxyServiceRegistry()
+    private ProxyServiceRegistry()
     {
-        ExecutorExecutor executorProxy = new ExecutorExecutor( executor );
-        socketAcceptor = new SocketAcceptor( 2, executorProxy );
+        socketAcceptor = new SocketAcceptor( 2, executor );
         SocketAcceptorConfig config = (SocketAcceptorConfig) socketAcceptor
                 .getDefaultConfig();
         config.setReuseAddress( true );
         
-        datagramAcceptor = new DatagramAcceptor( executorProxy );
+        datagramAcceptor = new DatagramAcceptor( executor );
         DatagramAcceptorConfig datagramConfig = (DatagramAcceptorConfig) datagramAcceptor
                 .getDefaultConfig();
         DatagramSessionConfig sessionConfig = (DatagramSessionConfig) datagramConfig
@@ -183,14 +182,12 @@
             try
             {
                 // Disconnect all clients
-                Set sessions = acceptor.getManagedSessions( address );
+                Set&lt;IoSession&gt; sessions = acceptor.getManagedSessions( address );
                 log.debug( &quot;{} has {} connected clients.&quot;, service.getName(),
                         sessions.size() );
-                for ( Object obj : sessions )
-                {
-                    IoSession session = (IoSession) obj;
+                
+                for ( IoSession session : sessions )
                     session.close();
-                }
                 
                 acceptor.unbind( address );
             } catch ( Exception e )
@@ -298,14 +295,5 @@
             // executor.getMaximumPoolSize() );
         }
     }
-    
-    /**
-     * @return a reference to the (unique) ProxyServiceRegistry instance
-     */
-    public static ProxyServiceRegistry getInstance()
-    {
-        return (ProxyServiceRegistry) Singleton
-                .getInstance( ProxyServiceRegistry.class );
-    }
-    
+       
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/Reactor.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/Reactor.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/Reactor.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -21,8 +21,12 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import com.google.inject.Inject;
+import com.google.inject.Singleton;
+
 import rtspproxy.config.Config;
 import rtspproxy.filter.FilterRegistry;
+import rtspproxy.filter.IFilterRegistry;
 import rtspproxy.jmx.JmxAgent;
 import rtspproxy.lib.Exceptions;
 import rtspproxy.rtp.range.PortrangeRtpServerSessionFactory;
@@ -32,36 +36,37 @@
  * The reactor expects a valid configuration before startup eg the global configuration must
  * have been filled before starting the reactor.
  */
-public class Reactor
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at Singleton</A>
+public class Reactor implements IReactor
 {
 
     private static Logger log = LoggerFactory.getLogger( Reactor.class );
 
-    private static ProxyServiceRegistry registry = null;
+    @Inject
+    private IProxyServiceRegistry serviceRegistry;
 
-    private static JmxAgent jmxAgent = null;
+    private JmxAgent jmxAgent;
     
-    private static boolean isStandalone = false;
+    @Inject
+    private IFilterRegistry filterRegistry;
     
-    private static FilterRegistry filterRegistry = null;
-
-    public static void setStandalone( boolean standalone )
+    private boolean isStandalone = false;
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.IReactor#setStandalone(boolean)
+     */
+    public void setStandalone( boolean standalone )
     {
         isStandalone = standalone;
     }
 
-    /**
-     * Constructor. Creates a new Reactor and starts it.
-     * The reactor relies on configuration info that has to be provided 
-     * &lt;b&gt;before&lt;/b&gt; starting the reactor.
-     * @exception Exception reactor startup failed.
+    /* (non-Javadoc)
+     * @see rtspproxy.IReactor#start()
      */
-    static public void start() throws Exception
+    public void start() throws Exception
     {
         log.info( &quot;Starting &quot; + Config.getName() + &quot; &quot; + Config.getVersion() );
 
-        registry = new ProxyServiceRegistry();
-
         // Register the &quot;<A HREF="rtsp://">rtsp://</A>&quot; protocol scheme
         System.setProperty( &quot;java.protocol.handler.pkgs&quot;, &quot;rtspproxy&quot; );
 
@@ -87,8 +92,8 @@
         rdtServerService.start();
 
         boolean enableJmx = Config.jmxEnable.getValue();
-        if ( enableJmx )
-            jmxAgent = new JmxAgent();
+         if ( enableJmx )
+             jmxAgent = new JmxAgent();
 
         filterRegistry = new FilterRegistry();
         filterRegistry.populateRegistry();		
@@ -99,7 +104,10 @@
         
     }
 
-    static public void stop()
+    /* (non-Javadoc)
+     * @see rtspproxy.IReactor#stop()
+     */
+    public void stop()
     {
         try {
             // TODO: check why null pointer exception
@@ -108,8 +116,8 @@
             if ( jmxAgent != null )
                 jmxAgent.stop();
             
-            if ( registry != null )
-                registry.unbindAll();
+            if ( serviceRegistry != null )
+                serviceRegistry.unbindAll();
             
             log.info( &quot;Shutdown completed&quot; );
 
@@ -122,9 +130,4 @@
             Runtime.getRuntime().halt( 0 );
     }
 
-    protected static ProxyServiceRegistry getRegistry()
-    {        
-        return registry;
-    }
-
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/ShutdownHandler.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/ShutdownHandler.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/ShutdownHandler.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -21,6 +21,8 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import com.google.inject.Inject;
+
 import rtspproxy.config.Config;
 import rtspproxy.lib.Exceptions;
 
@@ -31,18 +33,23 @@
  */
 public class ShutdownHandler extends Thread
 {
-
+    
     private static Logger log = LoggerFactory.getLogger( ShutdownHandler.class );
     
+    @Inject
+    private IReactor reactor;
+    
     @Override
     public void run()
     {
         log.info( &quot;Shutting down&quot; );
-        try {
+        try
+        {
             log.info( &quot;Stopping {} {}&quot;, Config.getName(), Config.getVersion() );
-            Reactor.stop();
-
-        } catch ( Exception e ) {
+            reactor.stop();
+            
+        } catch ( Exception e )
+        {
             log.error( &quot;Exception in the reactor: &quot;, e );
             Exceptions.logStackTrace( e );
         }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/config/Config.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/config/Config.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/config/Config.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -28,9 +28,6 @@
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentMap;
 
-import org.apache.log4j.Level;
-import org.apache.log4j.Logger;
-
 import rtspproxy.lib.Singleton;
 import rtspproxy.rtsp.Handler;
 
@@ -40,376 +37,390 @@
  */
 public class Config extends Singleton implements Observer
 {
-
+    
     /** Map that contains all the application parameters. */
-    private static ConcurrentMap&lt;String, Parameter&gt; parameters = new ConcurrentHashMap&lt;String, Parameter&gt;();
-
+    private static ConcurrentMap&lt;String, Parameter&gt; parameters =
+            new ConcurrentHashMap&lt;String, Parameter&gt;();
+    
     protected static void addParameter( Parameter parameter )
     {
         parameters.put( parameter.getName(), parameter );
     }
-
+    
     public static Parameter getParameter( String name )
     {
         if ( name == null )
             throw new IllegalArgumentException( &quot;name is null&quot; );
-
+        
         return parameters.get( name );
     }
-
+    
     public static Collection&lt;Parameter&gt; getAllParameters()
     {
         return parameters.values();
     }
-
+    
     protected static Map&lt;String, Parameter&gt; getParametersMap()
     {
         return parameters;
     }
-
-    public static final BooleanParameter debugEnabled = new BooleanParameter( &quot;debug&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Enables or disable application-wide debug messages.&quot; );
-
-    public static final IntegerParameter threadPoolSize = new IntegerParameter(
-            &quot;threadPoolSize&quot;, // name
-            0, // min value
-            2147483647, // max value
-            10, // default value
-            true, // mutable
-            &quot;Maximum size of the thread pool. The thread pool is shared &quot;
-                    + &quot;between all services found in RtspProxy.&quot; );
-
-    public static final IntegerParameter proxyRtspPort = new IntegerParameter(
-            &quot;proxy.rtspPort&quot;, // name
-            0, // min value
-            65536, // max value
-            Handler.DEFAULT_RTSP_PORT, // default value
-            true, // mutable
-            &quot;This is the port which the proxy will listen for &quot;
-                    + &quot;RTSP connection. The default is 554, like normal RTSP servers.&quot; );
-
-    public static final StringParameter proxyClientInterface = new StringParameter(
-            &quot;proxy.client.interface&quot;, // name
-            null, // default value
-            false, // mutable
-            &quot;Specify a network interface. Default is to listen on all interfaces.&quot; );
-
-    public static final StringParameter proxyServerInterface = new StringParameter(
-            &quot;proxy.server.interface&quot;, // name
-            null, // default value
-            false, // mutable
-            &quot;Specify a network interface. Default is to listen on all interfaces.&quot; );
-
-    public static final StringParameter proxyClientAddress = new StringParameter(
-            &quot;proxy.client.address&quot;, // name
-            null, // default value
-            false, // mutable
-            &quot;Specify a network address. Default is to listen on all addresses&quot; );
-
-    public static final StringParameter proxyServerAddress = new StringParameter(
-            &quot;proxy.server.address&quot;, // name
-            null, // default value
-            false, // mutable
-            &quot;Specify a network address.&quot; );
-
-    public static final IntegerParameter proxyServerRtpPort = new IntegerParameter(
-            &quot;proxy.server.rtpPort&quot;, // name
-            0, // min value
-            65536, // max value
-            8000, // default value
-            true, // mutable
-            &quot;Port to listen for RTP packets arriving from servers.&quot; );
-
-    public static final IntegerParameter proxyServerRtcpPort = new IntegerParameter(
-            &quot;proxy.server.rtcp.port&quot;, // name
-            0, // min value
-            65536, // max value
-            8001, // default value
-            true, // mutable
-            &quot;Port to listen for RTCP packets arriving from servers.&quot; );
-
-    public static final BooleanParameter proxyServerRtpMultiplePorts = new BooleanParameter(
-            &quot;proxy.server.rtpUsePortRange&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Enables the RTP/RTCP multiport handling.&quot; );
-
-    public static final IntegerParameter proxyServerRtpMinPort = new IntegerParameter(
-            &quot;proxy.server.rtpPortrange.minPort&quot;, // name
-            0, // min value
-            65536, // max value
-            9000, // default value
-            true, // mutable
-            &quot;Port to listen for RTP packets arriving from servers.&quot; );
-
-    public static final IntegerParameter proxyServerRtpMaxPort = new IntegerParameter(
-            &quot;proxy.server.rtpPortrange.maxPort&quot;, // name
-            0, // min value
-            65536, // max value
-            9100, // default value
-            true, // mutable
-            &quot;Port to listen for RTP packets arriving from servers.&quot; );
-
-    public static final IntegerParameter proxyServerRtpIdleTimeout = new IntegerParameter(
-            &quot;proxy.server.rtpPortrange.idleTimeout&quot;, // name
-            0, // min value
-            86400, // max value
-            3600, // default value
-            true, // mutable
-            &quot;Timeout an open RTP server port may linger around.&quot; );
-
-    public static final IntegerParameter proxyServerRtpIdleScanInterval = new IntegerParameter(
-            &quot;proxy.server.rtpPortrange.idleScanInterval&quot;, // name
-            0, // min value
-            86400, // max value
-            1800, // default value
-            true, // mutable
-            &quot;Scan interval on idle RTP server ports.&quot; );
-
-    public static final IntegerParameter proxyServerRtpThreadPoolSize = new IntegerParameter(
-            &quot;proxy.server.rtpPortrange.threadPoolSize&quot;, // name
-            0, // min value
-            2147483647, // max value
-            10, // default value
-            true, // mutable
-            &quot;Scan interval on idle RTP server ports.&quot; );
-
-    public static final IntegerParameter proxyClientRtpPort = new IntegerParameter(
-            &quot;proxy.client.rtpPort&quot;, // name
-            0, // min value
-            65536, // max value
-            8002, // default value
-            true, // mutable
-            &quot;Port to listen for RTP packets arriving from clients.&quot; );
-
-    public static final IntegerParameter proxyClientRtcpPort = new IntegerParameter(
-            &quot;proxy.client.rtcpPort&quot;, // name
-            0, // min value
-            65536, // max value
-            8003, // default value
-            true, // mutable
-            &quot;Port to listen for RTCP packets arriving from clients.&quot; );
-
-    public static final IntegerParameter proxyServerRdtPort = new IntegerParameter(
-            &quot;proxy.server.rdtPort&quot;, // name
-            0, // min value
-            65536, // max value
-            8020, // default value
-            true, // mutable
-            &quot;Port to listen for RDT packets arriving from servers.&quot; );
-
-    public static final IntegerParameter proxyClientRdtPort = new IntegerParameter(
-            &quot;proxy.client.rdtPort&quot;, // name
-            0, // min value
-            65536, // max value
-            8022, // default value
-            true, // mutable
-            &quot;Port to listen for RDT packets arriving from clients.&quot; );
-
-    public static final BooleanParameter proxyTransportRtpEnable = new BooleanParameter(
-            &quot;proxy.transport.rtp&quot;, // name
-            true, // default value
-            false, // mutable
-            &quot;Enables the UDP/AVP/RTP transport.&quot; );
-
-    public static final BooleanParameter proxyTransportRdtEnable = new BooleanParameter(
-            &quot;proxy.transport.rdt&quot;, // name
-            true, // default value
-            false, // mutable
-            &quot;Enables the x-udp-rdt transport.&quot; );
-
-    public static final BooleanParameter proxyLowerTransportSuppress = new BooleanParameter(
-            &quot;proxy.transport.hacks.lowerTransportSuppress&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Enables the x-udp-rdt transport.&quot; );
-
-    public static final BooleanParameter proxyRtspTransportSsrcDisable = new BooleanParameter(
-            &quot;proxy.transport.hacks.rtspTransportSsrcDisable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Disable the output of the SSRC transport attribute&quot; );
-
-    public static final BooleanParameter proxyRtspTransportSourceDisable = new BooleanParameter(
-            &quot;proxy.transport.rtspTransportSourceDisable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Disable the output of the SOURCE transport attribute&quot; );
-
-    public static final BooleanParameter proxyRtspKeepAlive = new BooleanParameter(
-            &quot;proxy.transport.hacks.rtspKeepAlive&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Enable keep-alive on RTSP connections to remote servers.&quot; );
-
-    public static final BooleanParameter proxyRtspOfferSsrcToServer = new BooleanParameter(
-            &quot;proxy.transport.hacks.offerRemoteSsrc&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Allow certain work-arounds for clients generating non-conformant RTSP protocol traffic.&quot; );
-
-    public static final BooleanParameter proxyServerRtpSsrcUnreliable = new BooleanParameter(
-            &quot;proxy.transport.hacks.rtpSsrcUnreliable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Disable the evaluation of the SSRC send by the remote streaming server.&quot; );
-
+    
+    public static final BooleanParameter debugEnabled =
+            new BooleanParameter( &quot;debug&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Enables or disable application-wide debug messages.&quot; );
+    
+    public static final IntegerParameter threadPoolSize =
+            new IntegerParameter( &quot;threadPoolSize&quot;, // name
+                    0, // min value
+                    2147483647, // max value
+                    10, // default value
+                    true, // mutable
+                    &quot;Maximum size of the thread pool. The thread pool is shared &quot;
+                            + &quot;between all services found in RtspProxy.&quot; );
+    
+    public static final IntegerParameter proxyRtspPort =
+            new IntegerParameter(
+                    &quot;proxy.rtspPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    Handler.DEFAULT_RTSP_PORT, // default value
+                    true, // mutable
+                    &quot;This is the port which the proxy will listen for &quot;
+                            + &quot;RTSP connection. The default is 554, like normal RTSP servers.&quot; );
+    
+    public static final StringParameter proxyClientInterface =
+            new StringParameter( &quot;proxy.client.interface&quot;, // name
+                    null, // default value
+                    false, // mutable
+                    &quot;Specify a network interface. Default is to listen on all interfaces.&quot; );
+    
+    public static final StringParameter proxyServerInterface =
+            new StringParameter( &quot;proxy.server.interface&quot;, // name
+                    null, // default value
+                    false, // mutable
+                    &quot;Specify a network interface. Default is to listen on all interfaces.&quot; );
+    
+    public static final StringParameter proxyClientAddress =
+            new StringParameter( &quot;proxy.client.address&quot;, // name
+                    null, // default value
+                    false, // mutable
+                    &quot;Specify a network address. Default is to listen on all addresses&quot; );
+    
+    public static final StringParameter proxyServerAddress =
+            new StringParameter( &quot;proxy.server.address&quot;, // name
+                    null, // default value
+                    false, // mutable
+                    &quot;Specify a network address.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpPort =
+            new IntegerParameter( &quot;proxy.server.rtpPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8000, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTP packets arriving from servers.&quot; );
+    
+    public static final IntegerParameter proxyServerRtcpPort =
+            new IntegerParameter( &quot;proxy.server.rtcp.port&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8001, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTCP packets arriving from servers.&quot; );
+    
+    public static final BooleanParameter proxyServerRtpMultiplePorts =
+            new BooleanParameter( &quot;proxy.server.rtpUsePortRange&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Enables the RTP/RTCP multiport handling.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpMinPort =
+            new IntegerParameter( &quot;proxy.server.rtpPortrange.minPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    9000, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTP packets arriving from servers.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpMaxPort =
+            new IntegerParameter( &quot;proxy.server.rtpPortrange.maxPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    9100, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTP packets arriving from servers.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpIdleTimeout =
+            new IntegerParameter( &quot;proxy.server.rtpPortrange.idleTimeout&quot;, // name
+                    0, // min value
+                    86400, // max value
+                    3600, // default value
+                    true, // mutable
+                    &quot;Timeout an open RTP server port may linger around.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpIdleScanInterval =
+            new IntegerParameter( &quot;proxy.server.rtpPortrange.idleScanInterval&quot;, // name
+                    0, // min value
+                    86400, // max value
+                    1800, // default value
+                    true, // mutable
+                    &quot;Scan interval on idle RTP server ports.&quot; );
+    
+    public static final IntegerParameter proxyServerRtpThreadPoolSize =
+            new IntegerParameter( &quot;proxy.server.rtpPortrange.threadPoolSize&quot;, // name
+                    0, // min value
+                    2147483647, // max value
+                    10, // default value
+                    true, // mutable
+                    &quot;Scan interval on idle RTP server ports.&quot; );
+    
+    public static final IntegerParameter proxyClientRtpPort =
+            new IntegerParameter( &quot;proxy.client.rtpPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8002, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTP packets arriving from clients.&quot; );
+    
+    public static final IntegerParameter proxyClientRtcpPort =
+            new IntegerParameter( &quot;proxy.client.rtcpPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8003, // default value
+                    true, // mutable
+                    &quot;Port to listen for RTCP packets arriving from clients.&quot; );
+    
+    public static final IntegerParameter proxyServerRdtPort =
+            new IntegerParameter( &quot;proxy.server.rdtPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8020, // default value
+                    true, // mutable
+                    &quot;Port to listen for RDT packets arriving from servers.&quot; );
+    
+    public static final IntegerParameter proxyClientRdtPort =
+            new IntegerParameter( &quot;proxy.client.rdtPort&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8022, // default value
+                    true, // mutable
+                    &quot;Port to listen for RDT packets arriving from clients.&quot; );
+    
+    public static final BooleanParameter proxyTransportRtpEnable =
+            new BooleanParameter( &quot;proxy.transport.rtp&quot;, // name
+                    true, // default value
+                    false, // mutable
+                    &quot;Enables the UDP/AVP/RTP transport.&quot; );
+    
+    public static final BooleanParameter proxyTransportRdtEnable =
+            new BooleanParameter( &quot;proxy.transport.rdt&quot;, // name
+                    true, // default value
+                    false, // mutable
+                    &quot;Enables the x-udp-rdt transport.&quot; );
+    
+    public static final BooleanParameter proxyLowerTransportSuppress =
+            new BooleanParameter(
+                    &quot;proxy.transport.hacks.lowerTransportSuppress&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Enables the x-udp-rdt transport.&quot; );
+    
+    public static final BooleanParameter proxyRtspTransportSsrcDisable =
+            new BooleanParameter(
+                    &quot;proxy.transport.hacks.rtspTransportSsrcDisable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Disable the output of the SSRC transport attribute&quot; );
+    
+    public static final BooleanParameter proxyRtspTransportSourceDisable =
+            new BooleanParameter( &quot;proxy.transport.rtspTransportSourceDisable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Disable the output of the SOURCE transport attribute&quot; );
+    
+    public static final BooleanParameter proxyRtspKeepAlive =
+            new BooleanParameter( &quot;proxy.transport.hacks.rtspKeepAlive&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Enable keep-alive on RTSP connections to remote servers.&quot; );
+    
+    public static final BooleanParameter proxyRtspOfferSsrcToServer =
+            new BooleanParameter(
+                    &quot;proxy.transport.hacks.offerRemoteSsrc&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Allow certain work-arounds for clients generating non-conformant RTSP protocol traffic.&quot; );
+    
+    public static final BooleanParameter proxyServerRtpSsrcUnreliable =
+            new BooleanParameter( &quot;proxy.transport.hacks.rtpSsrcUnreliable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Disable the evaluation of the SSRC send by the remote streaming server.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     // JMX
-
-    public static final BooleanParameter jmxEnable = new BooleanParameter( &quot;jmx.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the management subsystem (JMX).&quot; );
-
-    public static final StringParameter jmxAddress = new StringParameter( &quot;jmx.address&quot;, // name
-            &quot;localhost&quot;, // default value
-            false, // mutable
-            &quot;Host to bind the management services. Default is localhost, and the services &quot;
-                    + &quot;will only be reachable from local machine.&quot; );
-
-    public static final StringParameter jmxUser = new StringParameter( &quot;jmx.user&quot;, // name
-            &quot;&quot;, // default value
-            true, // mutable
-            &quot;Remote management administrator user name.&quot; );
-
-    public static final StringParameter jmxPassword = new StringParameter(
-            &quot;jmx.password&quot;, // name
-            &quot;&quot;, // default value
-            true, // mutable
-            &quot;Remote management administrator password.&quot; );
-
-    public static final BooleanParameter jmxWebEnable = new BooleanParameter(
-            &quot;jmx.web.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the Web management console.&quot; );
-
-    public static final IntegerParameter jmxWebPort = new IntegerParameter(
-            &quot;jmx.web.port&quot;, // name
-            0, // min value
-            65536, // max value
-            8000, // default value
-            false, // mutable
-            &quot;TCP port to be used for the Web Console.&quot; );
-
-    public static final BooleanParameter jmxConnectorServiceEnable = new BooleanParameter(
-            &quot;jmx.connectorService.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the JMX connector server.&quot; );
-
+    
+    public static final BooleanParameter jmxEnable =
+            new BooleanParameter( &quot;jmx.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the management subsystem (JMX).&quot; );
+    
+    public static final StringParameter jmxAddress =
+            new StringParameter( &quot;jmx.address&quot;, // name
+                    &quot;localhost&quot;, // default value
+                    false, // mutable
+                    &quot;Host to bind the management services. Default is localhost, and the services &quot;
+                            + &quot;will only be reachable from local machine.&quot; );
+    
+    public static final StringParameter jmxUser =
+            new StringParameter( &quot;jmx.user&quot;, // name
+                    &quot;&quot;, // default value
+                    true, // mutable
+                    &quot;Remote management administrator user name.&quot; );
+    
+    public static final StringParameter jmxPassword =
+            new StringParameter( &quot;jmx.password&quot;, // name
+                    &quot;&quot;, // default value
+                    true, // mutable
+                    &quot;Remote management administrator password.&quot; );
+    
+    public static final BooleanParameter jmxWebEnable =
+            new BooleanParameter( &quot;jmx.web.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the Web management console.&quot; );
+    
+    public static final IntegerParameter jmxWebPort =
+            new IntegerParameter( &quot;jmx.web.port&quot;, // name
+                    0, // min value
+                    65536, // max value
+                    8000, // default value
+                    false, // mutable
+                    &quot;TCP port to be used for the Web Console.&quot; );
+    
+    public static final BooleanParameter jmxConnectorServiceEnable =
+            new BooleanParameter( &quot;jmx.connectorService.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the JMX connector server.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     // Authentication filter
-
-    public static final BooleanParameter filtersAuthenticationEnable = new BooleanParameter(
-            &quot;filters.authentication.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the Authentication system&quot; );
-
-    public static final StringParameter filtersAuthenticationImplClass = new StringParameter(
-            &quot;filters.authentication.implClass&quot;, // name
-            &quot;rtspproxy.filter.authentication.SimpleAuthenticationProvider&quot;, // default
-            // value
-            false, // mutable
-            &quot;Implementation class for the authentication filter.&quot; );
-
-    public static final StringParameter filtersAuthenticationScheme = new StringParameter(
-            &quot;filters.authentication.scheme&quot;, // name
-            &quot;Basic&quot;, // default value
-            false, // mutable
-            &quot;Authentication scheme to be used. Can be 'Basic' or 'Digest'.&quot; );
-
+    
+    public static final BooleanParameter filtersAuthenticationEnable =
+            new BooleanParameter( &quot;filters.authentication.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the Authentication system&quot; );
+    
+    public static final StringParameter filtersAuthenticationImplClass =
+            new StringParameter(
+                    &quot;filters.authentication.implClass&quot;, // name
+                    &quot;rtspproxy.filter.authentication.SimpleAuthenticationProvider&quot;, // default
+                    // value
+                    false, // mutable
+                    &quot;Implementation class for the authentication filter.&quot; );
+    
+    public static final StringParameter filtersAuthenticationScheme =
+            new StringParameter( &quot;filters.authentication.scheme&quot;, // name
+                    &quot;Basic&quot;, // default value
+                    false, // mutable
+                    &quot;Authentication scheme to be used. Can be 'Basic' or 'Digest'.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     // IP address filter
-
-	public static final BooleanParameter filtersIpAddressEnable = new BooleanParameter(
-            &quot;filters.ipaddress.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the IP address filter.&quot; );
-
-    public static final StringParameter filtersIpAddressImplClass = new StringParameter(
-            &quot;filters.ipaddress.implClass&quot;, // name
-            &quot;rtspproxy.filter.ipaddress.SimpleIpAddressProvider&quot;, // default
-                                                                    // value
-            false, // mutable
-            &quot;Implementation class for the IP address filter.&quot; );
-
+    
+    public static final BooleanParameter filtersIpAddressEnable =
+            new BooleanParameter( &quot;filters.ipaddress.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the IP address filter.&quot; );
+    
+    public static final StringParameter filtersIpAddressImplClass =
+            new StringParameter( &quot;filters.ipaddress.implClass&quot;, // name
+                    &quot;rtspproxy.filter.ipaddress.SimpleIpAddressProvider&quot;, // default
+                    // value
+                    false, // mutable
+                    &quot;Implementation class for the IP address filter.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     // Accounting filter
-
-    public static final BooleanParameter filtersAccountingEnable = new BooleanParameter(
-            &quot;filters.accounting.enable&quot;, // name
-            false, // default value
-            false, // mutable
-            &quot;Controls the activation of the Accounting system&quot; );
-
-    public static final StringParameter filtersAccountingImplClass = new StringParameter(
-            &quot;filters.accounting.implClass&quot;, // name
-            &quot;rtspproxy.filter.accounting.SimpleAccountingProvider&quot;, // default value
-            false, // mutable
-            &quot;Implementation class for the accounting filter.&quot; );
-
-
+    
+    public static final BooleanParameter filtersAccountingEnable =
+            new BooleanParameter( &quot;filters.accounting.enable&quot;, // name
+                    false, // default value
+                    false, // mutable
+                    &quot;Controls the activation of the Accounting system&quot; );
+    
+    public static final StringParameter filtersAccountingImplClass =
+            new StringParameter( &quot;filters.accounting.implClass&quot;, // name
+                    &quot;rtspproxy.filter.accounting.SimpleAccountingProvider&quot;, // default
+                                                                            // value
+                    false, // mutable
+                    &quot;Implementation class for the accounting filter.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     // Rewrite filter
-
-    public static final BooleanParameter filtersRewriteEnable = new BooleanParameter(
-            &quot;filters.rewrite.enable&quot;, // name
-            false, // default value
-            true, // mutable
-            &quot;Controls the activation of the Rewrite system&quot; );
-
-    public static final StringParameter filtersRewriteImplClass = new StringParameter(
-            &quot;filters.rewrite.implClass&quot;, // name
-            &quot;rtspproxy.filter.authentication.SimpleAuthenticationProvider&quot;, // default
-            // value
-            true, // mutable
-            &quot;Implementation class for the authentication filter.&quot; );
-
+    
+    public static final BooleanParameter filtersRewriteEnable =
+            new BooleanParameter( &quot;filters.rewrite.enable&quot;, // name
+                    false, // default value
+                    true, // mutable
+                    &quot;Controls the activation of the Rewrite system&quot; );
+    
+    public static final StringParameter filtersRewriteImplClass =
+            new StringParameter(
+                    &quot;filters.rewrite.implClass&quot;, // name
+                    &quot;rtspproxy.filter.authentication.SimpleAuthenticationProvider&quot;, // default
+                    // value
+                    true, // mutable
+                    &quot;Implementation class for the authentication filter.&quot; );
+    
     // /////////////////////////////////////////////////////////
-
+    
     private static String rtspproxyHome;
-
+    
     private static String name;
-
+    
     private static String version;
-
+    
     private static String proxySignature;
-
+    
     private static Date startDate;
-
+    
     // /////////////////////////////////////////////////////////
-
+    
     public Config()
     {
         // Read home directory
         rtspproxyHome = System.getProperty( &quot;rtspproxy.home&quot; );
-        if ( rtspproxyHome == null ) {
+        if ( rtspproxyHome == null )
+        {
             rtspproxyHome = System.getProperty( &quot;user.dir&quot; );
         }
-
+        
         // Read program name and version
         Properties jarProps = new Properties();
-        try {
-            jarProps.load( Thread.currentThread().getContextClassLoader()
-                    .getResourceAsStream( &quot;META-INF/application.properties&quot; ) );
+        try
+        {
+            jarProps.load( Thread.currentThread().getContextClassLoader().getResourceAsStream(
+                                                                                               &quot;META-INF/application.properties&quot; ) );
             name = jarProps.getProperty( &quot;application.name&quot; );
             version = jarProps.getProperty( &quot;application.version&quot; );
-        } catch ( Exception e ) {
+        } catch ( Exception e )
+        {
             name = &quot;RtspProxy&quot;;
             version = &quot;&quot;;
         }
-
+        
         // Build proxy signature
         StringBuilder sb = new StringBuilder();
         sb.append( name ).append( ' ' ).append( version );
@@ -418,11 +429,11 @@
         sb.append( &quot; / &quot; ).append( System.getProperty( &quot;os.arch&quot; ) );
         sb.append( ')' );
         proxySignature = sb.toString();
-
+        
         startDate = new Date();
-
+        
     }
-
+    
     /**
      * Manage parameters value changes
      * 
@@ -433,7 +444,7 @@
         if ( !(o instanceof Parameter) )
             throw new IllegalArgumentException( &quot;Only observe parameters&quot; );
     }
-
+    
     /**
      * @return the application base dir or null if the home directory cannot be
      *         determined.
@@ -442,7 +453,7 @@
     {
         return rtspproxyHome;
     }
-
+    
     /**
      * @return Returns the application name.
      */
@@ -450,7 +461,7 @@
     {
         return name;
     }
-
+    
     /**
      * @return Returns the application version.
      */
@@ -458,7 +469,7 @@
     {
         return version;
     }
-
+    
     /**
      * @return Returns the proxySignature.
      */
@@ -466,45 +477,49 @@
     {
         return proxySignature;
     }
-
+    
     public static Date getStartDate()
     {
         return startDate;
     }
-
+    
     // /////////////////////////////////////////////////////////
-
+    
     protected static void updateDebugSettings()
     {
-        Logger rootLogger = Logger.getRootLogger();
-        if ( debugEnabled.getValue() ) {
-            rootLogger.setLevel( Level.DEBUG );
+        // Logger rootLogger = LoggerFactory.getLogger( Logger.ROOT_LOGGER_NAME );
+        if ( debugEnabled.getValue() )
+        {
+            // XXX: As we don't depend on Log4j we can't change logger
+            // levels.
+            // rootLogger.setLevel( Level.DEBUG );
         }
-
+        
         /*
          * else use the default level set in the log4j configuration file, which
          * is INFO
          */
     }
-
+    
     /**
      * @return a String containing all the parameters
      */
     public static String debugParameters()
     {
         StringBuilder sb = new StringBuilder();
-        Map&lt;String, Parameter&gt; parameters = new TreeMap&lt;String, Parameter&gt;( Config
-                .getParametersMap() );
-
+        Map&lt;String, Parameter&gt; parameters =
+                new TreeMap&lt;String, Parameter&gt;( Config.getParametersMap() );
+        
         sb.append( &quot;Parameters:\n&quot; );
-        for ( Parameter parameter : parameters.values() ) {
+        for ( Parameter parameter : parameters.values() )
+        {
             sb.append( parameter.getName() );
             sb.append( &quot;: &quot; );
             sb.append( parameter.getStringValue() );
             sb.append( '\n' );
         }
-
+        
         return sb.toString();
     }
-
+    
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterBase.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterBase.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterBase.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -10,42 +10,48 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import rtspproxy.Reactor;
+import rtspproxy.IReactor;
 
+import com.google.inject.Inject;
+
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  * 
  */
-public abstract class FilterBase&lt;T extends GenericProvider&gt; extends IoFilterAdapter
+public abstract class FilterBase&lt;T extends GenericProvider&gt; extends
+        IoFilterAdapter
 {
-
+    
     private static Logger log = LoggerFactory.getLogger( FilterBase.class );
-
+    
+    @Inject
+    private IReactor reactor;
+    
     /** running flag */
     private boolean isRunning = false;
-
+    
     /** chain name of filter */
     private String chainName;
-
+    
     private T providerReference = null;
-
+    
     // Abstract methods
     public abstract String getName();
-
+    
     public String getProviderClassName()
     {
         return null;
     }
-
+    
     protected Class&lt;T&gt; getProviderInterface()
     {
         return null;
     }
-
+    
     protected void setProvider( T provider )
     {
     }
-
+    
     /**
      * Subclasses can overload the method to read theyr own configuration
      * parameters.
@@ -56,7 +62,7 @@
     protected void doConfigure( Configuration configuration )
     {
     }
-
+    
     /**
      * query running flag
      */
@@ -64,36 +70,39 @@
     {
         return isRunning;
     }
-
+    
     /**
      * suspend the filter
      */
     public final void suspend()
     {
-        if ( providerReference != null )
-            providerReference.stop();
-
+        if ( providerReference != null ) providerReference.stop();
+        
         isRunning = false;
         log.info( &quot;{} suspended&quot;, getChainName() );
     }
-
+    
     /**
      * resume the filter
      */
     public final void resume()
     {
-        if ( providerReference != null ) {
-            try {
+        if ( providerReference != null )
+        {
+            try
+            {
                 providerReference.start();
-            } catch ( Exception e ) {
-                log.error( &quot;Error starting {}: {}&quot;, getProviderClassName(), e.getMessage() );
+            } catch ( Exception e )
+            {
+                log.error( &quot;Error starting {}: {}&quot;, getProviderClassName(),
+                           e.getMessage() );
                 return;
             }
         }
         isRunning = true;
         log.info( &quot;{} resumed&quot;, getChainName() );
     }
-
+    
     /**
      * get the object name of a more specific MBean
      */
@@ -101,81 +110,91 @@
     {
         return null;
     }
-
+    
     /**
      * get the chain name for the filter.
      */
     public String getChainName()
     {
-        if ( this.chainName == null ) {
+        if ( this.chainName == null )
+        {
             StringBuilder buf = new StringBuilder();
-
+            
             buf.append( getName() );
             buf.append( '/' );
             buf.append( getProviderInterface() );
-            if ( getProviderClassName() != null ) {
+            if ( getProviderClassName() != null )
+            {
                 buf.append( '/' );
                 buf.append( getProviderClassName() );
             }
             this.chainName = buf.toString();
         }
-
+        
         return this.chainName;
     }
-
+    
     @SuppressWarnings(&quot;unchecked&quot;)
     public final void configure( Configuration configuration )
     {
         // Configure the concrete class implementation
         doConfigure( configuration );
-
+        
         Class providerClass;
         String className = getProviderClassName();
-        if ( className == null ) {
+        if ( className == null )
+        {
             // The filter does not have a provider
             // system. Ignore it.
             return;
         }
-
-        try {
+        
+        try
+        {
             providerClass = Class.forName( className );
-
-        } catch ( Throwable t ) {
+            
+        } catch ( Throwable t )
+        {
             log.error( &quot;Class not found: {}&quot;, className );
-            Reactor.stop();
+            reactor.stop();
             return;
         }
-
+        
         // Check if the class implements the required interface
         boolean found = false;
         Class&lt;T&gt; requiredInterface = getProviderInterface();
-        for ( Class interFace : providerClass.getInterfaces() ) {
-            if ( interFace.equals( requiredInterface ) ) {
+        for ( Class interFace : providerClass.getInterfaces() )
+        {
+            if ( interFace.equals( requiredInterface ) )
+            {
                 found = true;
                 break;
             }
         }
-
-        if ( !found ) {
-            log.error( &quot;Class ({}) does not implement the {} interface.&quot;, providerClass,
-                    requiredInterface );
-            Reactor.stop();
+        
+        if ( !found )
+        {
+            log.error( &quot;Class ({}) does not implement the {} interface.&quot;,
+                       providerClass, requiredInterface );
+            reactor.stop();
             return;
         }
-
+        
         // Instanciate the provider and configure it.
-        try {
+        try
+        {
             T provider = (T) providerClass.newInstance();
             setProvider( provider );
             providerReference = provider;
             provider.configure( configuration );
             provider.start();
-
-        } catch ( Exception e ) {
+            
+        } catch ( Exception e )
+        {
             log.error( &quot;Error instanciaing class '{}'&quot;, providerClass );
-            Reactor.stop();
+            reactor.stop();
             return;
         }
     }
-
+    
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterRegistry.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterRegistry.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/FilterRegistry.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -22,7 +22,7 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import rtspproxy.Reactor;
+import rtspproxy.IReactor;
 import rtspproxy.config.Config;
 import rtspproxy.config.XMLConfigReader;
 import rtspproxy.filter.accounting.AccountingFilter;
@@ -30,158 +30,162 @@
 import rtspproxy.filter.ipaddress.IpAddressFilter;
 import rtspproxy.filter.rewrite.UrlRewritingFilter;
 import rtspproxy.jmx.JmxAgent;
-import rtspproxy.lib.Singleton;
 import rtspproxy.lib.Side;
 
+import com.google.inject.Inject;
+import com.google.inject.Singleton;
+
 /**
  * Filter registry. This registry is populated from the configuration on reactor
  * startup
  * 
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  */
-public class FilterRegistry extends Singleton
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at Singleton</A>
+public class FilterRegistry implements IFilterRegistry
 {
-
+    
     private static Logger log = LoggerFactory.getLogger( FilterRegistry.class );
-
+    
     private IpAddressFilter clientAddressFilter = null;
-
+    
     private IpAddressFilter serverAddressFilter = null;
-
+    
     private AuthenticationFilter authenticationFilter = null;
-
+    
     private AccountingFilter accountingFilter = null;
-
+    
     private UrlRewritingFilter clientRewritingFilter = null;
-
+    
     private UrlRewritingFilter serverRewritingFilter = null;
-
-    /**
-     * Get the active registry instance
-     */
-    public static FilterRegistry getInstance()
-    {
-        return (FilterRegistry) Singleton.getInstance( FilterRegistry.class );
-    }
-
+    
+    @Inject
+    private IReactor reactor;
+    
     // flag to determine if already populated
     private boolean populated = false;
-
-    /**
-     * populate from configuration
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#populateRegistry()
      */
     public void populateRegistry()
     {
         log.debug( &quot;Populate filter registry.&quot; );
-
-        if ( populated ) {
+        
+        if ( populated )
+        {
             log.debug( &quot;Filter registry already populated.&quot; );
             return;
         }
-
+        
         Configuration config = XMLConfigReader.getConfiguration();
-
-        try {
+        
+        try
+        {
             
             authenticationFilter = new AuthenticationFilter();
             authenticationFilter.configure( config );
             registerFilterMBean( authenticationFilter );
-            if ( Config.filtersAuthenticationEnable.getValue() ) {
+            if ( Config.filtersAuthenticationEnable.getValue() )
+            {
                 authenticationFilter.resume();
             }
-
+            
             clientAddressFilter = new IpAddressFilter( Side.Client );
             clientAddressFilter.configure( config );
             registerFilterMBean( clientAddressFilter );
-
+            
             serverAddressFilter = new IpAddressFilter( Side.Server );
             serverAddressFilter.configure( config );
             registerFilterMBean( serverAddressFilter );
-            if ( Config.filtersIpAddressEnable.getValue() ) {
+            if ( Config.filtersIpAddressEnable.getValue() )
+            {
                 clientAddressFilter.resume();
                 serverAddressFilter.resume();
             }
-
+            
             clientRewritingFilter = new UrlRewritingFilter( Side.Client );
             clientRewritingFilter.configure( config );
             registerFilterMBean( clientRewritingFilter );
-
+            
             serverRewritingFilter = new UrlRewritingFilter( Side.Server );
             serverRewritingFilter.configure( config );
             registerFilterMBean( serverRewritingFilter );
-            if ( Config.filtersRewriteEnable.getValue() ) {
+            if ( Config.filtersRewriteEnable.getValue() )
+            {
                 clientRewritingFilter.resume();
                 serverRewritingFilter.resume();
             }
-
+            
             accountingFilter = new AccountingFilter();
             accountingFilter.configure( config );
             registerFilterMBean( accountingFilter );
-            if ( Config.filtersAccountingEnable.getValue() ) {
+            if ( Config.filtersAccountingEnable.getValue() )
+            {
                 accountingFilter.resume();
             }
-
-        } catch ( Throwable t ) {
+            
+        } catch ( Throwable t )
+        {
             log.error( &quot;Failed to populate filter registry&quot;, t );
-
-            Reactor.stop();
+            reactor.stop();
         }
-
+        
         populated = true;
     }
-
+    
     private void registerFilterMBean( FilterBase filter )
     {
         if ( Config.jmxEnable.getValue() )
             JmxAgent.getInstance().registerFilter( filter );
     }
-
-    /**
-     * @return the accountingFilter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getAccountingFilter()
      */
     public AccountingFilter getAccountingFilter()
     {
         return accountingFilter;
     }
-
-    /**
-     * @return the addressFilter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getClientAddressFilter()
      */
     public IpAddressFilter getClientAddressFilter()
     {
         return clientAddressFilter;
     }
-
-    /**
-     * @return the server address filter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getServerAddressFilter()
      */
     public IpAddressFilter getServerAddressFilter()
     {
         return serverAddressFilter;
     }
-
-    /**
-     * @return the authenticationFilter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getAuthenticationFilter()
      */
     public AuthenticationFilter getAuthenticationFilter()
     {
         return authenticationFilter;
     }
-
-    /**
-     * @return the rewritingFilter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getClientRewritingFilter()
      */
     public UrlRewritingFilter getClientRewritingFilter()
     {
         return clientRewritingFilter;
     }
-
-    /**
-     * @return the rewritingFilter
+    
+    /* (non-Javadoc)
+     * @see rtspproxy.filter.IFilterRegistry#getServerRewritingFilter()
      */
     public UrlRewritingFilter getServerRewritingFilter()
     {
         return serverRewritingFilter;
     }
-
+    
 }

Added: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/IFilterRegistry.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/IFilterRegistry.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/IFilterRegistry.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -0,0 +1,49 @@
+package rtspproxy.filter;
+
+import com.google.inject.ImplementedBy;
+
+import rtspproxy.filter.accounting.AccountingFilter;
+import rtspproxy.filter.authentication.AuthenticationFilter;
+import rtspproxy.filter.ipaddress.IpAddressFilter;
+import rtspproxy.filter.rewrite.UrlRewritingFilter;
+
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at ImplementedBy</A>(FilterRegistry.class)
+public interface IFilterRegistry
+{
+    
+    /**
+     * populate from configuration
+     */
+    public void populateRegistry();
+    
+    /**
+     * @return the accountingFilter
+     */
+    public AccountingFilter getAccountingFilter();
+    
+    /**
+     * @return the addressFilter
+     */
+    public IpAddressFilter getClientAddressFilter();
+    
+    /**
+     * @return the server address filter
+     */
+    public IpAddressFilter getServerAddressFilter();
+    
+    /**
+     * @return the authenticationFilter
+     */
+    public AuthenticationFilter getAuthenticationFilter();
+    
+    /**
+     * @return the rewritingFilter
+     */
+    public UrlRewritingFilter getClientRewritingFilter();
+    
+    /**
+     * @return the rewritingFilter
+     */
+    public UrlRewritingFilter getServerRewritingFilter();
+    
+}
\ No newline at end of file


Property changes on: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/IFilterRegistry.java
___________________________________________________________________
Name: svn:keywords
   + Id URL Rev

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/RtspFilters.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/RtspFilters.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/RtspFilters.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -23,6 +23,8 @@
 import org.apache.mina.common.IoFilterChainBuilder;
 import org.apache.mina.filter.codec.ProtocolCodecFilter;
 
+import com.google.inject.Inject;
+
 import rtspproxy.filter.accounting.AccountingFilter;
 import rtspproxy.filter.authentication.AuthenticationFilter;
 import rtspproxy.filter.ipaddress.IpAddressFilter;
@@ -37,12 +39,15 @@
  */
 public abstract class RtspFilters implements IoFilterChainBuilder
 {
-
-    private static final IoFilter codecFilter = new ProtocolCodecFilter( RtspCodecFactory
-            .getInstance() );
-
+    
+    private static final IoFilter codecFilter =
+            new ProtocolCodecFilter( RtspCodecFactory.getInstance() );
+    
     private static final String rtspCodecNAME = &quot;rtspCodec&quot;;
-
+    
+    @Inject
+    private IFilterRegistry filterRegistry;
+    
     /**
      * IP Address filter.
      * &lt;p&gt;
@@ -53,17 +58,15 @@
     protected void addIpAddressFilter( IoFilterChain chain, Side side )
     {
         IpAddressFilter filter;
-        if ( side == Side.Client )
-            filter = FilterRegistry.getInstance().getClientAddressFilter();
-        else
-            filter = FilterRegistry.getInstance().getServerAddressFilter();
-
-        if ( filter == null || !filter.isRunning() )
-            return;
-
+        if ( side == Side.Client ) filter =
+                filterRegistry.getClientAddressFilter();
+        else filter = filterRegistry.getServerAddressFilter();
+        
+        if ( filter == null || !filter.isRunning() ) return;
+        
         chain.addFirst( filter.getChainName(), filter );
     }
-
+    
     /**
      * The RTSP codec filter is always present. Translates the incoming streams
      * into RTSP messages.
@@ -72,46 +75,41 @@
     {
         chain.addLast( rtspCodecNAME, codecFilter );
     }
-
+    
     /**
      * Authentication filter.
      */
     protected void addAuthenticationFilter( IoFilterChain chain )
     {
-        AuthenticationFilter filter = FilterRegistry.getInstance()
-                .getAuthenticationFilter();
-
-        if ( !filter.isRunning() )
-            return;
-
+        AuthenticationFilter filter = filterRegistry.getAuthenticationFilter();
+        
+        if ( !filter.isRunning() ) return;
+        
         chain.addAfter( rtspCodecNAME, filter.getChainName(), filter );
     }
-
+    
     protected void addAccountingFilter( IoFilterChain chain )
     {
-        AccountingFilter filter = FilterRegistry.getInstance().getAccountingFilter();
-
-        if ( !filter.isRunning() )
-            return;
-
+        AccountingFilter filter = filterRegistry.getAccountingFilter();
+        
+        if ( !filter.isRunning() ) return;
+        
         chain.addAfter( rtspCodecNAME, filter.getChainName(), filter );
     }
-
+    
     protected void addRewriteFilter( IoFilterChain chain, Side side )
     {
         UrlRewritingFilter filter;
-
-        if ( side == Side.Client )
-            filter = FilterRegistry.getInstance().getClientRewritingFilter();
-        else
-            filter = FilterRegistry.getInstance().getServerRewritingFilter();
-
-        if ( !filter.isRunning() )
-            return;
-
+        
+        if ( side == Side.Client ) filter =
+                filterRegistry.getClientRewritingFilter();
+        else filter = filterRegistry.getServerRewritingFilter();
+        
+        if ( !filter.isRunning() ) return;
+        
         chain.addAfter( rtspCodecNAME, filter.getChainName(), filter );
     }
-
+    
     protected void addControlFilter( IoFilterChain chain )
     {
         // XXX: disabled

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication/AuthenticationFilter.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication/AuthenticationFilter.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/authentication/AuthenticationFilter.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -25,6 +25,9 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import com.google.inject.Inject;
+
+import rtspproxy.IReactor;
 import rtspproxy.Reactor;
 import rtspproxy.config.Config;
 import rtspproxy.filter.FilterBase;
@@ -42,32 +45,39 @@
  */
 public class AuthenticationFilter extends FilterBase&lt;AuthenticationProvider&gt;
 {
-
-    private static Logger log = LoggerFactory.getLogger( AuthenticationFilter.class );
-
+    
+    private static Logger log =
+            LoggerFactory.getLogger( AuthenticationFilter.class );
+    
     private static final String FilterNAME = &quot;authenticationFilter&quot;;
-
-    private static final String ATTR = AuthenticationFilter.class.getName() + &quot;Attr&quot;;
-
-    private static final Map&lt;String, Class&gt; schemeRegistry = new HashMap&lt;String, Class&gt;();
-
-    static {
+    
+    private static final String ATTR =
+            AuthenticationFilter.class.getName() + &quot;Attr&quot;;
+    
+    private static final Map&lt;String, Class&lt;? extends AuthenticationScheme&gt;&gt; schemeRegistry =
+            new HashMap&lt;String, Class&lt;? extends AuthenticationScheme&gt;&gt;();
+    
+    @Inject
+    private IReactor reactor;
+    
+    static
+    {
         // Fill in known schemes
         schemeRegistry.put( &quot;basic&quot;, BasicAuthentication.class );
         schemeRegistry.put( &quot;digest&quot;, DigestAuthentication.class );
     }
-
+    
     /** Backend provider. */
     private AuthenticationProvider provider;
-
+    
     /** Different authentication schemes implementation */
     private AuthenticationScheme scheme = null;
-
-	public static String getAttrName()
-	{
-		return ATTR;
-	}
-
+    
+    public static String getAttrName()
+    {
+        return ATTR;
+    }
+    
     /**
      * Construct a new AuthenticationFilter. Looks at the configuration to load
      * the choseen backend implementation.
@@ -76,23 +86,28 @@
     {
         // Validate the choosen authentication scheme
         String schemeName = Config.filtersAuthenticationScheme.getValue();
-        Class schemeClass = schemeRegistry.get( schemeName.toLowerCase() );
-        if ( schemeClass == null ) {
+        Class&lt;? extends AuthenticationScheme&gt; schemeClass =
+                schemeRegistry.get( schemeName.toLowerCase() );
+        if ( schemeClass == null )
+        {
             // scheme not found
-            log.error( &quot;Authentication Scheme not found: {}. Valid values are: {}&quot;,
-                    schemeName, schemeRegistry.keySet() );
-            Reactor.stop();
+            log.error(
+                       &quot;Authentication Scheme not found: {}. Valid values are: {}&quot;,
+                       schemeName, schemeRegistry.keySet() );
+            reactor.stop();
             return;
         }
-
+        
         // Instanciate the selected scheme
-        try {
-            scheme = (AuthenticationScheme) schemeClass.newInstance();
-        } catch ( Exception e ) {
+        try
+        {
+            scheme = schemeClass.newInstance();
+        } catch ( Exception e )
+        {
             log.error( &quot;Error instanciating class: {}&quot;, schemeClass );
         }
     }
-
+    
     /*
      * (non-Javadoc)
      * 
@@ -103,7 +118,7 @@
     {
         return FilterNAME;
     }
-
+    
     /*
      * (non-Javadoc)
      * 
@@ -114,7 +129,7 @@
     {
         return Config.filtersAuthenticationImplClass.getValue();
     }
-
+    
     /*
      * (non-Javadoc)
      * 
@@ -125,7 +140,7 @@
     {
         return AuthenticationProvider.class;
     }
-
+    
     /*
      * (non-Javadoc)
      * 
@@ -136,7 +151,7 @@
     {
         this.provider = provider;
     }
-
+    
     /*
      * (non-Javadoc)
      * 
@@ -144,79 +159,90 @@
      *      org.apache.mina.common.IoSession, java.lang.Object)
      */
     @Override
-    public void messageReceived( NextFilter nextFilter, IoSession session, Object message )
-            throws Exception
+    public void messageReceived( NextFilter nextFilter, IoSession session,
+            Object message ) throws Exception
     {
-        if ( !(message instanceof RtspRequest) ) {
+        if ( !(message instanceof RtspRequest) )
+        {
             // Shouldn't happen
             log.warn( &quot;Object message is not a RTSP request&quot; );
             return;
         }
-
-        if ( session.getAttribute( ATTR ) != null ) {
+        
+        if ( session.getAttribute( ATTR ) != null )
+        {
             // Client already autheticated
             log.debug( &quot;Already authenticaed: {}&quot;, session.getAttribute( ATTR ) );
             nextFilter.messageReceived( session, message );
         }
-
-        String authString = ((RtspMessage) message).getHeader( &quot;Proxy-Authorization&quot; );
-
-        if ( authString == null ) {
+        
+        String authString =
+                ((RtspMessage) message).getHeader( &quot;Proxy-Authorization&quot; );
+        
+        if ( authString == null )
+        {
             log.debug( &quot;RTSP message: \n{}&quot;, message );
-            final RtspResponse response = RtspResponse
-                    .errorResponse( RtspCode.ProxyAuthenticationRequired );
-
+            final RtspResponse response =
+                    RtspResponse.errorResponse( RtspCode.ProxyAuthenticationRequired );
+            
             response.setHeader( &quot;Proxy-Authenticate&quot;, scheme.getName() + &quot; &quot;
                     + scheme.getChallenge() );
-
+            
             log.debug( &quot;Client MUST athenticate to Proxy: \n{}&quot;, response );
             session.write( response );
             return;
         }
-
-        if ( !validateAuthenticationScheme( authString ) ) {
+        
+        if ( !validateAuthenticationScheme( authString ) )
+        {
             log.debug( &quot;Authentication scheme not valid: {}&quot;, authString );
-            RtspResponse response = RtspResponse.errorResponse( RtspCode.BadRequest );
+            RtspResponse response =
+                    RtspResponse.errorResponse( RtspCode.BadRequest );
             session.write( response );
             return;
         }
-
+        
         log.debug( &quot;RTSP message: \n{}&quot;, message );
-
+        
         // Check the authentication credentials
-        final Credentials credentials = scheme.getCredentials( (RtspMessage) message );
-
+        final Credentials credentials =
+                scheme.getCredentials( (RtspMessage) message );
+        
         boolean authenticationOk = false;
-        if ( credentials != null ) {
+        if ( credentials != null )
+        {
             String password = provider.getPassword( credentials.getUserName() );
-            if ( password != null &amp;&amp; scheme.computeAuthentication( credentials, password ) ) {
+            if ( password != null
+                    &amp;&amp; scheme.computeAuthentication( credentials, password ) )
+            {
                 authenticationOk = true;
             }
         }
-
-        if ( !authenticationOk ) {
+        
+        if ( !authenticationOk )
+        {
             log.info( &quot;Authentication failed for user: {}&quot;, credentials );
-            RtspResponse response = RtspResponse
-                    .errorResponse( RtspCode.ProxyAuthenticationRequired );
+            RtspResponse response =
+                    RtspResponse.errorResponse( RtspCode.ProxyAuthenticationRequired );
             response.setHeader( &quot;Proxy-Authenticate&quot;, scheme.getName() + &quot; &quot;
                     + scheme.getChallenge() );
-
+            
             session.write( response );
             return;
         }
-
+        
         log.debug( &quot;Authentication successfull for user: {}&quot;, credentials );
-
+        
         /*
          * Mark the session with an &quot;authenticated&quot; attribute. This will prevent
          * the check for the credentials for every message received.
          */
         session.setAttribute( ATTR, credentials.getUserName() );
-
+        
         // Forward message
         nextFilter.messageReceived( session, message );
     }
-
+    
     /**
      * Gets the authentication scheme stated by the client.
      * 
@@ -226,18 +252,19 @@
     private boolean validateAuthenticationScheme( String authString )
     {
         String schemeName;
-        try {
+        try
+        {
             schemeName = authString.split( &quot; &quot; )[0];
-        } catch ( IndexOutOfBoundsException e ) {
+        } catch ( IndexOutOfBoundsException e )
+        {
             // Malformed auth string
             return false;
         }
-
-        if ( schemeName.equalsIgnoreCase( scheme.getName() ) )
-            return true;
-
+        
+        if ( schemeName.equalsIgnoreCase( scheme.getName() ) ) return true;
+        
         // Scheme not valid
         return false;
     }
-
+    
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking/RdtSessionTrackingFilter.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking/RdtSessionTrackingFilter.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/filter/tracking/RdtSessionTrackingFilter.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -16,80 +16,90 @@
 import rtspproxy.rtsp.RtspTransportList;
 
 /**
- * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- * TODO: to be implemented
+ * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>) TODO: to be implemented
  */
-public abstract class RdtSessionTrackingFilter extends FilterBase {
-	
-	private static Logger logger = LoggerFactory.getLogger(RdtSessionTrackingFilter.class);
+public abstract class RdtSessionTrackingFilter extends FilterBase
+{
 
-	public static final String FilterNAME = &quot;rdtTrackingFilter&quot;;
+    private static Logger logger = LoggerFactory
+            .getLogger( RdtSessionTrackingFilter.class );
 
-	public String getName()
-        {
-                return FilterNAME;
-        }
+    public static final String FilterNAME = &quot;rdtTrackingFilter&quot;;
 
-        public void setProvider( GenericProvider provider )
-        {
-              	// XXX
-        }
+    @Override
+    public String getName()
+    {
+        return FilterNAME;
+    }
 
-        public Class getProviderInterface()
-        {
-                return null;
-        }
+    @Override
+    public void setProvider( GenericProvider provider )
+    {
+        // XXX
+    }
 
-        public String getProviderClassName()
-        {
-                // TODO: to be implemented
-                return &quot;&quot;; // Config.filtersImplClass.getValue();
+    @Override
+    public Class getProviderInterface()
+    {
+        return null;
+    }
+
+    @Override
+    public String getProviderClassName()
+    {
+        // TODO: to be implemented
+        return &quot;&quot;; // Config.filtersImplClass.getValue();
+    }
+
+    /**
+     * check the message for following conditions
+     */
+    protected void handleMessage( IoSession session, Object message )
+    {
+        if ( Config.proxyTransportRdtEnable.getValue() &amp;&amp; message instanceof RtspResponse ) {
+            RtspResponse resp = (RtspResponse) message;
+
+            logger.debug( &quot;analyzing RTSP response message&quot; );
+            if ( resp.getRequestVerb() == RtspRequest.Verb.SETUP ) {
+                logger.debug( &quot;found SETUP response&quot; );
+
+                String transHdr = resp.getHeader( &quot;Transport&quot; );
+
+                if ( transHdr != null ) {
+                    logger.debug( &quot;SETUP response has transport header: &quot; + transHdr );
+
+                    RtspTransportList rtl = new RtspTransportList( transHdr );
+
+                    if ( rtl.count() == 1 ) {
+                        // at this point we can only have one transport.
+                        // Everything else is a protocol violation
+                        RtspTransport transport = rtl.get( 0 );
+
+                        if ( transport.getTransportProtocol() == RtspTransport.TransportProtocol.RDT ) {
+                            logger.debug( &quot;found RDT transport protocol&quot; );
+
+                            if ( transport.getDeliveryType() == RtspTransport.DeliveryType.unicast
+                                    &amp;&amp; transport.getLowerTransport() == RtspTransport.LowerTransport.UDP ) {
+                                logger
+                                        .debug( &quot;found RDT/UDP/unicast transport header, server_port=&quot;
+                                                + transport.getServerPort()[0]
+                                                + &quot;, client_port=&quot;
+                                                + transport.getClientPort()[0] );
+
+                                handleTransportRdtUdpUnicast( session, transport );
+                            }
+                        }
+                    } else
+                        logger.error( &quot;found invalid transport header: &quot; + transHdr );
+                }
+            }
         }
+    }
 
-	/**
-	 * check the message for following conditions
-	 */
-	protected void handleMessage(IoSession session, Object message) {
-		if(Config.proxyTransportRdtEnable.getValue() &amp;&amp; message instanceof RtspResponse) {
-			RtspResponse resp = (RtspResponse)message;
-			
-			logger.debug(&quot;analyzing RTSP response message&quot;);
-			if(resp.getRequestVerb() == RtspRequest.Verb.SETUP) {
-				logger.debug(&quot;found SETUP response&quot;);
-				
-				String transHdr = resp.getHeader(&quot;Transport&quot;);
-				
-				if(transHdr != null) {
-					logger.debug(&quot;SETUP response has transport header: &quot; + transHdr);
-					
-					RtspTransportList rtl = new RtspTransportList(transHdr);
-					
-					if(rtl.count() == 1) {
-						// at this point we can only have one transport. Everything else is a protocol violation
-						RtspTransport transport = rtl.get(0);
-						
-						if(transport.getTransportProtocol() == RtspTransport.TransportProtocol.RDT) {
-							logger.debug(&quot;found RDT transport protocol&quot;);
-							
-							if(transport.getDeliveryType() == RtspTransport.DeliveryType.unicast
-									&amp;&amp; transport.getLowerTransport() == RtspTransport.LowerTransport.UDP) {
-								logger.debug(&quot;found RDT/UDP/unicast transport header, server_port=&quot; 
-										+ transport.getServerPort()[0] + &quot;, client_port=&quot; 
-										+ transport.getClientPort()[0]);
-								
-								handleTransportRdtUdpUnicast(session, transport);
-							}
-						}
-					} else 
-						logger.error(&quot;found invalid transport header: &quot; + transHdr);
-				}
-			}
-		}
-	}
-	
-	/**
-	 * handle the extracted RTSP response RDT/UDP/unicast transport header
-	 */
-	protected abstract void handleTransportRdtUdpUnicast(IoSession session, RtspTransport transport);
-	
+    /**
+     * handle the extracted RTSP response RDT/UDP/unicast transport header
+     */
+    protected abstract void handleTransportRdtUdpUnicast( IoSession session,
+            RtspTransport transport );
+
 }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/JmxAgent.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/JmxAgent.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/JmxAgent.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -38,10 +38,10 @@
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import rtspproxy.IReactor;
 import rtspproxy.ProxyService;
 import rtspproxy.RdtClientService;
 import rtspproxy.RdtServerService;
-import rtspproxy.Reactor;
 import rtspproxy.RtcpClientService;
 import rtspproxy.RtcpServerService;
 import rtspproxy.RtpClientService;
@@ -60,6 +60,8 @@
 import rtspproxy.rtp.range.PortrangeRtpServerSession;
 import rtspproxy.rtp.range.PortrangeRtpServerSessionFactory;
 
+import com.google.inject.Inject;
+
 /**
  * Entry point class for all the JMX interface.
  * 
@@ -85,6 +87,9 @@
     public static final String LOGGER_DOMAIN = &quot;RtspProxy.Logger&quot;;
 
     private MBeanServer mbeanServer = null;
+    
+    @Inject
+    private IReactor reactor;
 
     /**
      * Creates a MBean server and attach all the MBeans to it. Also starts, if
@@ -138,7 +143,7 @@
 
         } catch ( Exception e ) {
             log.error( &quot;Exception: &quot;, e );
-            Reactor.stop();
+            reactor.stop();
         }
     }
 

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/ProxySessionList.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/ProxySessionList.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/jmx/ProxySessionList.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -18,7 +18,6 @@
 
 package rtspproxy.jmx;
 
-import java.lang.reflect.Constructor;
 import java.util.Set;
 
 import javax.management.Attribute;
@@ -27,7 +26,6 @@
 import javax.management.DynamicMBean;
 import javax.management.InvalidAttributeValueException;
 import javax.management.MBeanAttributeInfo;
-import javax.management.MBeanConstructorInfo;
 import javax.management.MBeanException;
 import javax.management.MBeanInfo;
 import javax.management.ReflectionException;

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedByte.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedByte.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedByte.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -28,7 +28,7 @@
 	private short value;
 
 	public UnsignedByte(byte c) {
-		value = c;
+		value = (short) (c &amp; 0xFF);
 	}
 
 	public UnsignedByte(short c) {

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedInt.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedInt.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedInt.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -32,15 +32,15 @@
 	private long value;
 
 	public UnsignedInt(byte c) {
-		value = c;
+		value = c &amp; 0xFF;
 	}
 
 	public UnsignedInt(short c) {
-		value = c;
+		value = c &amp; 0xFFFF;
 	}
 
 	public UnsignedInt(int c) {
-		value = c;
+		value = c &amp; 0xFFFFFFFFL;
 	}
 
 	public UnsignedInt(long c) {

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedShort.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedShort.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/lib/number/UnsignedShort.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -28,11 +28,11 @@
 	private int value;
 
 	public UnsignedShort(byte c) {
-		value = c;
+		value = c &amp; 0xFF;
 	}
 
 	public UnsignedShort(short c) {
-		value = c;
+		value = c &amp; 0xFFFF;
 	}
 
 	public UnsignedShort(int c) {

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/proxy/ProxyHandler.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/proxy/ProxyHandler.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/proxy/ProxyHandler.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -28,6 +28,7 @@
 import java.util.Queue;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentLinkedQueue;
+import java.util.concurrent.Executor;
 
 import org.apache.mina.common.ConnectFuture;
 import org.apache.mina.common.IoFuture;
@@ -35,13 +36,12 @@
 import org.apache.mina.common.IoSession;
 import org.apache.mina.common.TrafficMask;
 import org.apache.mina.common.WriteFuture;
-import org.apache.mina.filter.executor.ExecutorExecutor;
 import org.apache.mina.transport.socket.nio.SocketConnector;
 import org.apache.mina.transport.socket.nio.SocketSessionConfig;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import rtspproxy.ProxyServiceRegistry;
+import rtspproxy.IProxyServiceRegistry;
 import rtspproxy.RdtClientService;
 import rtspproxy.RdtServerService;
 import rtspproxy.RtcpClientService;
@@ -63,6 +63,8 @@
 import rtspproxy.rtsp.RtspTransport.LowerTransport;
 import rtspproxy.rtsp.RtspTransport.TransportProtocol;
 
+import com.google.inject.Inject;
+
 /**
  * @author Matteo Merli
  */
@@ -94,6 +96,9 @@
     
     private WriteListener writeListener = new WriteListener( this );
     
+    @Inject
+    private IProxyServiceRegistry serviceRegistry;
+    
     /**
      * Creates a new ProxyHandler from a client side protocol session.
      * 
@@ -589,9 +594,7 @@
         if ( port == -1 ) port = url.getDefaultPort();
         
         // Create TCP/IP connector.
-        ExecutorExecutor executor =
-                new ExecutorExecutor(
-                        ProxyServiceRegistry.getInstance().getExecutor() );
+        Executor executor = serviceRegistry.getExecutor();
         SocketConnector connector = new SocketConnector( 1, executor );
         connector.setFilterChainBuilder( new RtspServerFilters() );
         
@@ -744,7 +747,7 @@
     {
         WriteFuture future =
                 session.write( RtspResponse.errorResponse( errorCode ) );
-        future.addListener( new CloseAllListener( this ) );        
+        future.addListener( new CloseAllListener( this ) );
     }
     
     private static class WriteListener implements IoFutureListener

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/rdt/RdtProtocolDecoder.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/rdt/RdtProtocolDecoder.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/rdt/RdtProtocolDecoder.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -12,45 +12,70 @@
 
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- *
+ * 
  */
-public class RdtProtocolDecoder implements ProtocolDecoder {
+public class RdtProtocolDecoder implements ProtocolDecoder
+{
+    
+    private static Logger logger = LoggerFactory
+            .getLogger( RdtProtocolDecoder.class );
+    
+    /**
+     * 
+     */
+    RdtProtocolDecoder()
+    {
+    }
+    
+    /*
+     * (non-Javadoc)
+     * 
+     * @see org.apache.mina.filter.codec.ProtocolDecoder#decode(org.apache.mina.common.IoSession,
+     *      org.apache.mina.common.ByteBuffer,
+     *      org.apache.mina.filter.codec.ProtocolDecoderOutput)
+     */
+    public void decode( IoSession ioSession, ByteBuffer buffer,
+            ProtocolDecoderOutput out ) throws Exception
+    {
+        try
+        {
+            RdtPacket rdtPacket = RdtPacketDecoder.decode( buffer );
+            
+            if ( logger.isDebugEnabled() )
+                logger.debug( &quot;received RDT packet: &quot; + rdtPacket
+                        + &quot; from client &quot; + ioSession.getRemoteAddress() );
+            
+            if ( rdtPacket == null )
+                throw new IllegalStateException(
+                        &quot;RDT network packet cannot be decoded&quot; );
+            
+            out.write( rdtPacket );
+        } catch ( Exception e )
+        {
+            logger.debug( &quot;error decoding packet&quot;, e );
+            
+            throw e;
+        }
+    }
+    
+    
+    
+    /* (non-Javadoc)
+     * @see org.apache.mina.filter.codec.ProtocolDecoder#finishDecode(org.apache.mina.common.IoSession, org.apache.mina.filter.codec.ProtocolDecoderOutput)
+     */
+    public void finishDecode( IoSession session, ProtocolDecoderOutput out ) throws Exception
+    {
+        // TODO Auto-generated method stub
+    }
 
-	private static Logger logger = LoggerFactory.getLogger(RdtProtocolDecoder.class);
-
-	/**
-	 * 
-	 */
-	RdtProtocolDecoder() {
-	}
-
-	/* (non-Javadoc)
-	 * @see org.apache.mina.filter.codec.ProtocolDecoder#decode(org.apache.mina.common.IoSession, org.apache.mina.common.ByteBuffer, org.apache.mina.filter.codec.ProtocolDecoderOutput)
-	 */
-	public void decode(IoSession ioSession, ByteBuffer buffer,
-			ProtocolDecoderOutput out) throws Exception {
-		try {
-		RdtPacket rdtPacket = RdtPacketDecoder.decode(buffer);
-	
-		if(logger.isDebugEnabled())
-			logger.debug(&quot;received RDT packet: &quot; + rdtPacket + &quot; from client &quot; + ioSession.getRemoteAddress());
-
-		if(rdtPacket == null)
-			throw new IllegalStateException(&quot;RDT network packet cannot be decoded&quot;);
-		
-		out.write(rdtPacket);
-		} catch(Exception e) {
-			logger.debug(&quot;error decoding packet&quot;, e);
-			
-			throw e;
-		}
-	}
-
-	/* (non-Javadoc)
-	 * @see org.apache.mina.filter.codec.ProtocolDecoder#dispose(org.apache.mina.common.IoSession)
-	 */
-	public void dispose(IoSession arg0) throws Exception {
-
-	}
-
+    /*
+     * (non-Javadoc)
+     * 
+     * @see org.apache.mina.filter.codec.ProtocolDecoder#dispose(org.apache.mina.common.IoSession)
+     */
+    public void dispose( IoSession arg0 ) throws Exception
+    {
+        
+    }
+    
 }

Deleted: trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpRtcpFilterChainBuilder.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpRtcpFilterChainBuilder.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpRtcpFilterChainBuilder.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -1,29 +0,0 @@
-/**
- * 
- */
-package rtspproxy.rtp.range;
-
-import org.apache.mina.common.IoFilterChain;
-import org.apache.mina.common.IoFilterChainBuilder;
-import org.apache.mina.filter.ThreadPoolFilter;
-
-/**
- * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- *
- */
-public class RtpRtcpFilterChainBuilder implements IoFilterChainBuilder {
-
-	private ThreadPoolFilter filter = new ThreadPoolFilter(&quot;RtpRtcpPortRangeThreadPool&quot;);
-	
-	RtpRtcpFilterChainBuilder() {}
-	
-	/* (non-Javadoc)
-	 * @see org.apache.mina.common.IoFilterChainBuilder#buildFilterChain(org.apache.mina.common.IoFilterChain)
-	 */
-	public void buildFilterChain(IoFilterChain arg0) throws Exception {
-	}
-
-	void setPoolSize(int size) {
-		this.filter.setMaximumPoolSize(size);
-	}
-}

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpServerSessionFactory.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpServerSessionFactory.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/range/RtpServerSessionFactory.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -50,9 +50,6 @@
     // RTCP acceptor
     private DatagramAcceptor rtcpAcceptor = new DatagramAcceptor();
 
-    // Filter chain builder
-    private RtpRtcpFilterChainBuilder chainBuilder = new RtpRtcpFilterChainBuilder();
-
     private long idleTimeout;
 
     /**
@@ -70,10 +67,6 @@
         this.basePort = basePort;
         this.idleTimeout = idleTimeout;
 
-        this.chainBuilder.setPoolSize( threadPoolSize );
-        this.rtpAcceptor.setFilterChainBuilder( this.chainBuilder );
-        this.rtcpAcceptor.setFilterChainBuilder( this.chainBuilder );
-
         Config.proxyServerRtpThreadPoolSize.addObserver( this );
         Config.proxyServerRtpIdleTimeout.addObserver( this );
     }
@@ -189,10 +182,7 @@
         if ( o instanceof Parameter ) {
             Parameter p = (Parameter) o;
 
-            if ( p.equals( Config.proxyServerRtpThreadPoolSize ) )
-                this.chainBuilder.setPoolSize( Config.proxyServerRtpThreadPoolSize
-                        .getValue() );
-            else if ( p.equals( Config.proxyServerRtpIdleTimeout ) )
+            if ( p.equals( Config.proxyServerRtpIdleTimeout ) )
                 this.idleTimeout = Config.proxyServerRtpIdleTimeout.getValue();
         }
     }

Modified: trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp/RtcpPacket.java
===================================================================
--- trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp/RtcpPacket.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/main/java/rtspproxy/rtp/rtcp/RtcpPacket.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -95,7 +95,8 @@
 		version = (byte) ( ( c &amp; 0xC0 ) &gt;&gt; 6 );
 		padding = ( ( c &amp; 0x20 ) &gt;&gt; 5 ) == 1;
 		count = (byte) ( c &amp; 0x1F );
-		packetType = new UnsignedByte( buffer.get() );
+        byte b = buffer.get();
+        packetType = new UnsignedByte( b );
 		length = buffer.getShort();
 
 		ssrc = new UnsignedInt( buffer.getInt() );

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/NptTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/NptTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/NptTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,23 +17,22 @@
  */
 package rtspproxy.lib;
 
-import junit.framework.TestCase;
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertNotNull;
 
+import org.testng.annotations.Test;
+
 /**
  * @author mat
  */
-public class NptTest extends TestCase
<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">+ at Test</A>
+public class NptTest
 {
-
-	public static void main( String[] args )
-	{
-		junit.textui.TestRunner.run( NptTest.class );
-	}
-
 	/*
 	 * Test method for 'rtspproxy.lib.Npt.fromString(String)'
 	 */
-	public void testFromString1()
+	@Test
+    public void fromString1()
 	{
 		String s = &quot;npt=0-23.4&quot;;
 		Npt npt = Npt.fromString( s );
@@ -48,7 +47,8 @@
 	/*
 	 * Test method for 'rtspproxy.lib.Npt.fromString(String)'
 	 */
-	public void testFromString2()
+	@Test
+    public void fromString2()
 	{
 		String s = &quot;npt=0-&quot;;
 		Npt npt = Npt.fromString( s );
@@ -63,7 +63,8 @@
 	/*
 	 * Test method for 'rtspproxy.lib.Npt.fromString(String)'
 	 */
-	public void testFromString3()
+	@Test
+    public void fromString3()
 	{
 		String s = &quot;npt=12.34-23.49&quot;;
 		Npt npt = Npt.fromString( s );
@@ -78,7 +79,8 @@
 	/*
 	 * Test method for 'rtspproxy.lib.Npt.fromString(String)'
 	 */
-	public void testFromString4()
+	@Test
+    public void fromString4()
 	{
 		String s = &quot;npt=now-&quot;;
 		Npt npt = Npt.fromString( s );

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedByteTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedByteTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedByteTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,109 +17,133 @@
  */
 package rtspproxy.lib.number;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Test;
 
 /**
  * @author Matteo Merli
  */
-public class UnsignedByteTest extends TestCase {
-
-	public static void main(String[] args) {
-		junit.textui.TestRunner.run(UnsignedByteTest.class);
-	}
-
-	public void test1() {
-		UnsignedByte n = new UnsignedByte(0xFF);
-
-		assertEquals((short) 0xFF, n.shortValue());
-		assertEquals(0xFF, n.intValue());
-		assertEquals(0xFFL, n.longValue());
-		assertEquals(&quot;FF&quot;, n.toHexString());
-		assertEquals(&quot;255&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF }, n.getBytes()));
-
-	}
-
-	public void test2() {
-		UnsignedByte n = new UnsignedByte(0xFFL);
-
-		assertEquals((short) 0xFF, n.shortValue());
-		assertEquals(0xFF, n.intValue());
-		assertEquals(0xFFL, n.longValue());
-		assertEquals(&quot;FF&quot;, n.toHexString());
-		assertEquals(&quot;255&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test3() {
-		UnsignedByte n = UnsignedByte.fromString(&quot;FF&quot;, 16);
-
-		assertEquals((short) 0xFF, n.shortValue());
-		assertEquals(0xFF, n.intValue());
-		assertEquals(0xFFL, n.longValue());
-		assertEquals(&quot;FF&quot;, n.toHexString());
-		assertEquals(&quot;255&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test4() {
-		UnsignedByte n = UnsignedByte.fromString(&quot;255&quot;);
-
-		assertEquals((short) 0xFF, n.shortValue());
-		assertEquals(0xFF, n.intValue());
-		assertEquals(0xFFL, n.longValue());
-		assertEquals(&quot;FF&quot;, n.toHexString());
-		assertEquals(&quot;255&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test5() {
-		UnsignedByte n = UnsignedByte.fromBytes(new byte[] { (byte) 0xFF });
-
-		assertEquals((short) 0xFF, n.shortValue());
-		assertEquals(0xFF, n.intValue());
-		assertEquals(0xFFL, n.longValue());
-		assertEquals(&quot;FF&quot;, n.toHexString());
-		assertEquals(&quot;255&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test6() {
-		UnsignedByte n1 = new UnsignedByte(0);
-		UnsignedByte n2 = new UnsignedByte(0xF);
-		UnsignedByte n3 = new UnsignedByte(0xFFL);
-		UnsignedByte n4 = UnsignedByte.fromBytes(new byte[] { (byte) 0xFF });
-
-		assertTrue(n1.compareTo(n1) == 0);
-		assertTrue(n1.compareTo(n2) &lt; 0);
-		assertTrue(n1.compareTo(n3) &lt; 0);
-		assertTrue(n1.compareTo(n4) &lt; 0);
-		assertTrue(n2.compareTo(n1) &gt; 0);
-		assertTrue(n2.compareTo(n2) == 0);
-		assertTrue(n2.compareTo(n3) &lt; 0);
-		assertTrue(n2.compareTo(n4) &lt; 0);
-		assertTrue(n3.compareTo(n1) &gt; 0);
-		assertTrue(n3.compareTo(n2) &gt; 0);
-		assertTrue(n3.compareTo(n3) == 0);
-		assertTrue(n3.compareTo(n4) == 0);
-		assertTrue(n4.compareTo(n1) &gt; 0);
-		assertTrue(n4.compareTo(n2) &gt; 0);
-		assertTrue(n4.compareTo(n3) == 0);
-		assertTrue(n4.compareTo(n4) == 0);
-	}
-
-	public void testShift() {
-		UnsignedByte n = new UnsignedByte(0x01);
-
-		n.shiftLeft(7);
-		assertEquals(0x80, n.intValue());
-		n.shiftRight(3);
-		assertEquals(0x10, n.intValue());
-
-		n = new UnsignedByte(0xFF);
-		n.shiftRight(4);
-		assertEquals(0x0F, n.intValue());
-	}
+public class UnsignedByteTest
+{
+    @Test
+    public void testNegative()
+    {
+        UnsignedByte n = new UnsignedByte( (byte)202 );
+        
+        assertEquals( (short) 202, n.shortValue() );
+        assertEquals( 202, n.intValue() );
+        assertEquals( 202L, n.longValue() );
+        assertEquals( &quot;202&quot;, n.toString() );
+    }
+    
+    @Test()
+    public void test1()
+    {
+        UnsignedByte n = new UnsignedByte( 0xFF );
+        
+        assertEquals( (short) 0xFF, n.shortValue() );
+        assertEquals( 0xFF, n.intValue() );
+        assertEquals( 0xFFL, n.longValue() );
+        assertEquals( &quot;FF&quot;, n.toHexString() );
+        assertEquals( &quot;255&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF }, n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test2()
+    {
+        UnsignedByte n = new UnsignedByte( 0xFFL );
+        
+        assertEquals( (short) 0xFF, n.shortValue() );
+        assertEquals( 0xFF, n.intValue() );
+        assertEquals( 0xFFL, n.longValue() );
+        assertEquals( &quot;FF&quot;, n.toHexString() );
+        assertEquals( &quot;255&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF }, n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test3()
+    {
+        UnsignedByte n = UnsignedByte.fromString( &quot;FF&quot;, 16 );
+        
+        assertEquals( (short) 0xFF, n.shortValue() );
+        assertEquals( 0xFF, n.intValue() );
+        assertEquals( 0xFFL, n.longValue() );
+        assertEquals( &quot;FF&quot;, n.toHexString() );
+        assertEquals( &quot;255&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF }, n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test4()
+    {
+        UnsignedByte n = UnsignedByte.fromString( &quot;255&quot; );
+        
+        assertEquals( (short) 0xFF, n.shortValue() );
+        assertEquals( 0xFF, n.intValue() );
+        assertEquals( 0xFFL, n.longValue() );
+        assertEquals( &quot;FF&quot;, n.toHexString() );
+        assertEquals( &quot;255&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF }, n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test5()
+    {
+        UnsignedByte n = UnsignedByte.fromBytes( new byte[] { (byte) 0xFF } );
+        
+        assertEquals( (short) 0xFF, n.shortValue() );
+        assertEquals( 0xFF, n.intValue() );
+        assertEquals( 0xFFL, n.longValue() );
+        assertEquals( &quot;FF&quot;, n.toHexString() );
+        assertEquals( &quot;255&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF }, n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test6()
+    {
+        UnsignedByte n1 = new UnsignedByte( 0 );
+        UnsignedByte n2 = new UnsignedByte( 0xF );
+        UnsignedByte n3 = new UnsignedByte( 0xFFL );
+        UnsignedByte n4 = UnsignedByte.fromBytes( new byte[] { (byte) 0xFF } );
+        
+        assertTrue( n1.compareTo( n1 ) == 0 );
+        assertTrue( n1.compareTo( n2 ) &lt; 0 );
+        assertTrue( n1.compareTo( n3 ) &lt; 0 );
+        assertTrue( n1.compareTo( n4 ) &lt; 0 );
+        assertTrue( n2.compareTo( n1 ) &gt; 0 );
+        assertTrue( n2.compareTo( n2 ) == 0 );
+        assertTrue( n2.compareTo( n3 ) &lt; 0 );
+        assertTrue( n2.compareTo( n4 ) &lt; 0 );
+        assertTrue( n3.compareTo( n1 ) &gt; 0 );
+        assertTrue( n3.compareTo( n2 ) &gt; 0 );
+        assertTrue( n3.compareTo( n3 ) == 0 );
+        assertTrue( n3.compareTo( n4 ) == 0 );
+        assertTrue( n4.compareTo( n1 ) &gt; 0 );
+        assertTrue( n4.compareTo( n2 ) &gt; 0 );
+        assertTrue( n4.compareTo( n3 ) == 0 );
+        assertTrue( n4.compareTo( n4 ) == 0 );
+    }
+    
+    @Test()
+    public void testShift()
+    {
+        UnsignedByte n = new UnsignedByte( 0x01 );
+        
+        n.shiftLeft( 7 );
+        assertEquals( 0x80, n.intValue() );
+        n.shiftRight( 3 );
+        assertEquals( 0x10, n.intValue() );
+        
+        n = new UnsignedByte( 0xFF );
+        n.shiftRight( 4 );
+        assertEquals( 0x0F, n.intValue() );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedIntTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedIntTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedIntTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,102 +17,122 @@
  */
 package rtspproxy.lib.number;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Test;
 
 /**
  * @author Matteo Merli
  */
-public class UnsignedIntTest extends TestCase {
-
-	public static void main(String[] args) {
-		junit.textui.TestRunner.run(UnsignedIntTest.class);
-	}
-	
-	public void test1() {
-		UnsignedInt n = new UnsignedInt(0xFFFFFFFF);
-
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-
-	}
-
-	public void test2() {
-		UnsignedInt n = new UnsignedInt(0xFFFFFFFFL);
-
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-
-	}
-
-	public void test3() {
-		UnsignedInt n = UnsignedInt.fromString(&quot;FFFFFFFF&quot;, 16);
-
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test4() {
-		UnsignedInt n = UnsignedInt.fromString(&quot;4294967295&quot;);
-
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test5() {
-		UnsignedInt n = UnsignedInt.fromBytes(new byte[] { (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF });
-
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test6() {
-		UnsignedInt n1 = new UnsignedInt(0);
-		UnsignedInt n2 = new UnsignedInt(0xFFFF);
-		UnsignedInt n3 = new UnsignedInt(0xFFFFFFFFL);
-
-		assertTrue(n1.compareTo(n2) &lt; 0);
-		assertTrue(n2.compareTo(n3) &lt; 0);
-		assertTrue(n1.compareTo(n3) &lt; 0);
-		assertTrue(n2.compareTo(n2) == 0);
-		assertTrue(n1.compareTo(new UnsignedInt(0)) == 0);
-	}
-	
-	public void testShift() {
-		UnsignedInt n = new UnsignedInt(0x01);
-
-		n.shiftLeft(8);
-		assertEquals(0x100, n.intValue());
-		n.shiftLeft(16);
-		assertEquals(0x1000000, n.intValue());
-		n.shiftRight(24);
-		assertEquals(0x01, n.intValue());
-
-		n = new UnsignedInt(0xACL);
-		n.shiftLeft(8);
-		assertEquals(0xAC00, n.intValue());
-		n.shiftLeft(16);
-		assertEquals(0xAC000000L, n.longValue());
-		n.shiftRight(8);
-		assertEquals(0xAC0000L, n.longValue());
-		n.shiftRight(20);
-		assertEquals(0xAL, n.longValue());
-	}
+public class UnsignedIntTest
+{
+    
+    @Test()
+    public void test1()
+    {
+        UnsignedInt n = new UnsignedInt( 0xFFFFFFFF );
+        
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test2()
+    {
+        UnsignedInt n = new UnsignedInt( 0xFFFFFFFFL );
+        
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test3()
+    {
+        UnsignedInt n = UnsignedInt.fromString( &quot;FFFFFFFF&quot;, 16 );
+        
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test4()
+    {
+        UnsignedInt n = UnsignedInt.fromString( &quot;4294967295&quot; );
+        
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test5()
+    {
+        UnsignedInt n =
+                UnsignedInt.fromBytes( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                                   (byte) 0xFF, (byte) 0xFF } );
+        
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test6()
+    {
+        UnsignedInt n1 = new UnsignedInt( 0 );
+        UnsignedInt n2 = new UnsignedInt( 0xFFFF );
+        UnsignedInt n3 = new UnsignedInt( 0xFFFFFFFFL );
+        
+        assertTrue( n1.compareTo( n2 ) &lt; 0 );
+        assertTrue( n2.compareTo( n3 ) &lt; 0 );
+        assertTrue( n1.compareTo( n3 ) &lt; 0 );
+        assertTrue( n2.compareTo( n2 ) == 0 );
+        assertTrue( n1.compareTo( new UnsignedInt( 0 ) ) == 0 );
+    }
+    
+    @Test()
+    public void testShift()
+    {
+        UnsignedInt n = new UnsignedInt( 0x01 );
+        
+        n.shiftLeft( 8 );
+        assertEquals( 0x100, n.intValue() );
+        n.shiftLeft( 16 );
+        assertEquals( 0x1000000, n.intValue() );
+        n.shiftRight( 24 );
+        assertEquals( 0x01, n.intValue() );
+        
+        n = new UnsignedInt( 0xACL );
+        n.shiftLeft( 8 );
+        assertEquals( 0xAC00, n.intValue() );
+        n.shiftLeft( 16 );
+        assertEquals( 0xAC000000L, n.longValue() );
+        n.shiftRight( 8 );
+        assertEquals( 0xAC0000L, n.longValue() );
+        n.shiftRight( 20 );
+        assertEquals( 0xAL, n.longValue() );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedLongTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedLongTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedLongTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,132 +17,159 @@
  */
 package rtspproxy.lib.number;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Test;
 
 /**
  * @author Matteo Merli
  */
-public class UnsignedLongTest extends TestCase {
-
-	public static void main(String[] args) {
-		junit.textui.TestRunner.run(UnsignedLongTest.class);
-	}
-
-	public void test1() {
-		UnsignedLong n = new UnsignedLong(0xFFFFFFFFFFFFFFFFL);
-
-		assertEquals(0xFFFFFFFFFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;18446744073709551615&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test2() {
-		UnsignedLong n = new UnsignedLong(0xFFFFFFFFL);
-
-		assertEquals(0xFFFFFFFF, n.intValue());
-		assertEquals(0xFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;00000000FFFFFFFF&quot;, n.toHexString(true));
-		assertEquals(&quot;4294967295&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { 0, 0, 0, 0, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-
-	}
-
-	public void test3() {
-		UnsignedLong n = UnsignedLong.fromString(&quot;FFFFFFFFFFFFFFFF&quot;, 16);
-
-		assertEquals(0xFFFFFFFFFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;18446744073709551615&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test4() {
-		UnsignedLong n = UnsignedLong.fromString(&quot;18446744073709551615&quot;);
-
-		assertEquals(0xFFFFFFFFFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;18446744073709551615&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test5() {
-		UnsignedLong n = UnsignedLong.fromBytes(new byte[] { (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF });
-
-		assertEquals(0xFFFFFFFFFFFFFFFFL, n.longValue());
-		assertEquals(&quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString());
-		assertEquals(&quot;18446744073709551615&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF }, n.getBytes()));
-	}
-
-	public void test6() {
-		UnsignedLong n1 = new UnsignedLong(0);
-		UnsignedLong n2 = new UnsignedLong(0xFFFF);
-		UnsignedLong n3 = new UnsignedLong(0xFFFFFFFFL);
-		UnsignedLong n4 = new UnsignedLong(0xFFFFFFFFFFFFFFFFL);
-		UnsignedLong n5 = UnsignedLong.fromBytes(new byte[] { (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,
-				(byte) 0xFF, (byte) 0xFF, (byte) 0xFF });
-
-		assertTrue(n1.compareTo(n1) == 0);
-		assertTrue(n1.compareTo(n2) &lt; 0);
-		assertTrue(n1.compareTo(n3) &lt; 0);
-		assertTrue(n1.compareTo(n4) &lt; 0);
-		assertTrue(n1.compareTo(n5) &lt; 0);
-		assertTrue(n2.compareTo(n1) &gt; 0);
-		assertTrue(n2.compareTo(n2) == 0);
-		assertTrue(n2.compareTo(n3) &lt; 0);
-		assertTrue(n2.compareTo(n4) &lt; 0);
-		assertTrue(n2.compareTo(n5) &lt; 0);
-		assertTrue(n3.compareTo(n1) &gt; 0);
-		assertTrue(n3.compareTo(n2) &gt; 0);
-		assertTrue(n3.compareTo(n3) == 0);
-		assertTrue(n3.compareTo(n4) &lt; 0);
-		assertTrue(n3.compareTo(n5) &lt; 0);
-		assertTrue(n4.compareTo(n1) &gt; 0);
-		assertTrue(n4.compareTo(n2) &gt; 0);
-		assertTrue(n4.compareTo(n3) &gt; 0);
-		assertTrue(n4.compareTo(n4) == 0);
-		assertTrue(n4.compareTo(n5) == 0);
-		assertTrue(n5.compareTo(n1) &gt; 0);
-		assertTrue(n5.compareTo(n2) &gt; 0);
-		assertTrue(n5.compareTo(n3) &gt; 0);
-		assertTrue(n5.compareTo(n4) == 0);
-		assertTrue(n5.compareTo(n5) == 0);
-	}
-
-	public void testShift() {
-		UnsignedLong n = new UnsignedLong(0x01);
-
-		n.shiftLeft(8);
-		assertEquals(0x100, n.intValue());
-		n.shiftLeft(16);
-		assertEquals(0x1000000, n.intValue());
-		n.shiftRight(24);
-		assertEquals(0x01, n.intValue());
-
-		n = new UnsignedLong(0xACL);
-		n.shiftLeft(8);
-		assertEquals(0xAC00, n.intValue());
-		n.shiftLeft(24);
-		assertEquals(0xAC00000000L, n.longValue());
-		n.shiftLeft(24);
-		assertEquals(0xAC00000000000000L, n.longValue());
-		n.shiftRight(32);
-		assertEquals(0xAC000000L, n.longValue());
-	}
+public class UnsignedLongTest
+{
+    
+    @Test()
+    public void test1()
+    {
+        UnsignedLong n = new UnsignedLong( 0xFFFFFFFFFFFFFFFFL );
+        
+        assertEquals( 0xFFFFFFFFFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;18446744073709551615&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test2()
+    {
+        UnsignedLong n = new UnsignedLong( 0xFFFFFFFFL );
+        
+        assertEquals( 0xFFFFFFFF, n.intValue() );
+        assertEquals( 0xFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;00000000FFFFFFFF&quot;, n.toHexString( true ) );
+        assertEquals( &quot;4294967295&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { 0, 0, 0, 0, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF }, n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test3()
+    {
+        UnsignedLong n = UnsignedLong.fromString( &quot;FFFFFFFFFFFFFFFF&quot;, 16 );
+        
+        assertEquals( 0xFFFFFFFFFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;18446744073709551615&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test4()
+    {
+        UnsignedLong n = UnsignedLong.fromString( &quot;18446744073709551615&quot; );
+        
+        assertEquals( 0xFFFFFFFFFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;18446744073709551615&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test5()
+    {
+        UnsignedLong n =
+                UnsignedLong.fromBytes( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF } );
+        
+        assertEquals( 0xFFFFFFFFFFFFFFFFL, n.longValue() );
+        assertEquals( &quot;FFFFFFFFFFFFFFFF&quot;, n.toHexString() );
+        assertEquals( &quot;18446744073709551615&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF,
+                                               (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test6()
+    {
+        UnsignedLong n1 = new UnsignedLong( 0 );
+        UnsignedLong n2 = new UnsignedLong( 0xFFFF );
+        UnsignedLong n3 = new UnsignedLong( 0xFFFFFFFFL );
+        UnsignedLong n4 = new UnsignedLong( 0xFFFFFFFFFFFFFFFFL );
+        UnsignedLong n5 =
+                UnsignedLong.fromBytes( new byte[] { (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF,
+                                                    (byte) 0xFF, (byte) 0xFF } );
+        
+        assertTrue( n1.compareTo( n1 ) == 0 );
+        assertTrue( n1.compareTo( n2 ) &lt; 0 );
+        assertTrue( n1.compareTo( n3 ) &lt; 0 );
+        assertTrue( n1.compareTo( n4 ) &lt; 0 );
+        assertTrue( n1.compareTo( n5 ) &lt; 0 );
+        assertTrue( n2.compareTo( n1 ) &gt; 0 );
+        assertTrue( n2.compareTo( n2 ) == 0 );
+        assertTrue( n2.compareTo( n3 ) &lt; 0 );
+        assertTrue( n2.compareTo( n4 ) &lt; 0 );
+        assertTrue( n2.compareTo( n5 ) &lt; 0 );
+        assertTrue( n3.compareTo( n1 ) &gt; 0 );
+        assertTrue( n3.compareTo( n2 ) &gt; 0 );
+        assertTrue( n3.compareTo( n3 ) == 0 );
+        assertTrue( n3.compareTo( n4 ) &lt; 0 );
+        assertTrue( n3.compareTo( n5 ) &lt; 0 );
+        assertTrue( n4.compareTo( n1 ) &gt; 0 );
+        assertTrue( n4.compareTo( n2 ) &gt; 0 );
+        assertTrue( n4.compareTo( n3 ) &gt; 0 );
+        assertTrue( n4.compareTo( n4 ) == 0 );
+        assertTrue( n4.compareTo( n5 ) == 0 );
+        assertTrue( n5.compareTo( n1 ) &gt; 0 );
+        assertTrue( n5.compareTo( n2 ) &gt; 0 );
+        assertTrue( n5.compareTo( n3 ) &gt; 0 );
+        assertTrue( n5.compareTo( n4 ) == 0 );
+        assertTrue( n5.compareTo( n5 ) == 0 );
+    }
+    
+    @Test()
+    public void testShift()
+    {
+        UnsignedLong n = new UnsignedLong( 0x01 );
+        
+        n.shiftLeft( 8 );
+        assertEquals( 0x100, n.intValue() );
+        n.shiftLeft( 16 );
+        assertEquals( 0x1000000, n.intValue() );
+        n.shiftRight( 24 );
+        assertEquals( 0x01, n.intValue() );
+        
+        n = new UnsignedLong( 0xACL );
+        n.shiftLeft( 8 );
+        assertEquals( 0xAC00, n.intValue() );
+        n.shiftLeft( 24 );
+        assertEquals( 0xAC00000000L, n.longValue() );
+        n.shiftLeft( 24 );
+        assertEquals( 0xAC00000000000000L, n.longValue() );
+        n.shiftRight( 32 );
+        assertEquals( 0xAC000000L, n.longValue() );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedShortTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedShortTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/lib/number/UnsignedShortTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -17,121 +17,134 @@
  */
 package rtspproxy.lib.number;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Test;
 
 /**
  * @author Matteo Merli
  */
-public class UnsignedShortTest extends TestCase {
-
-	public static void main(String[] args) {
-		junit.textui.TestRunner.run(UnsignedShortTest.class);
-	}
-
-	public void test1() {
-		UnsignedShort n = new UnsignedShort(0xFFFF);
-
-		assertEquals((short) 0xFFFF, n.shortValue());
-		assertEquals(0xFFFF, n.intValue());
-		assertEquals(0xFFFFL, n.longValue());
-		assertEquals(&quot;FFFF&quot;, n.toHexString());
-		assertEquals(&quot;65535&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF }, n
-				.getBytes()));
-
-	}
-
-	public void test2() {
-		UnsignedShort n = new UnsignedShort(0xFFFFL);
-
-		assertEquals((short) 0xFFFF, n.shortValue());
-		assertEquals(0xFFFF, n.intValue());
-		assertEquals(0xFFFFL, n.longValue());
-		assertEquals(&quot;FFFF&quot;, n.toHexString());
-		assertEquals(&quot;65535&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF }, n
-				.getBytes()));
-
-	}
-
-	public void test3() {
-		UnsignedShort n = UnsignedShort.fromString(&quot;FFFF&quot;, 16);
-
-		assertEquals((short) 0xFFFF, n.shortValue());
-		assertEquals(0xFFFF, n.intValue());
-		assertEquals(0xFFFFL, n.longValue());
-		assertEquals(&quot;FFFF&quot;, n.toHexString());
-		assertEquals(&quot;65535&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF }, n
-				.getBytes()));
-	}
-
-	public void test4() {
-		UnsignedShort n = UnsignedShort.fromString(&quot;65535&quot;);
-
-		assertEquals((short) 0xFFFF, n.shortValue());
-		assertEquals(0xFFFF, n.intValue());
-		assertEquals(0xFFFFL, n.longValue());
-		assertEquals(&quot;FFFF&quot;, n.toHexString());
-		assertEquals(&quot;65535&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF }, n
-				.getBytes()));
-	}
-
-	public void test5() {
-		UnsignedShort n = UnsignedShort.fromBytes(new byte[] { (byte) 0xFF,
-				(byte) 0xFF });
-
-		assertEquals((short) 0xFFFF, n.shortValue());
-		assertEquals(0xFFFF, n.intValue());
-		assertEquals(0xFFFFL, n.longValue());
-		assertEquals(&quot;FFFF&quot;, n.toHexString());
-		assertEquals(&quot;65535&quot;, n.toString());
-		assertTrue(Arrays.equals(new byte[] { (byte) 0xFF, (byte) 0xFF }, n
-				.getBytes()));
-	}
-
-	public void test6() {
-		UnsignedShort n1 = new UnsignedShort(0);
-		UnsignedShort n2 = new UnsignedShort(0xFF);
-		UnsignedShort n3 = new UnsignedShort(0xFFFFL);
-		UnsignedShort n4 = UnsignedShort.fromBytes(new byte[] { (byte) 0xFF,
-				(byte) 0xFF });
-
-		assertTrue(n1.compareTo(n1) == 0);
-		assertTrue(n1.compareTo(n2) &lt; 0);
-		assertTrue(n1.compareTo(n3) &lt; 0);
-		assertTrue(n1.compareTo(n4) &lt; 0);
-		assertTrue(n2.compareTo(n1) &gt; 0);
-		assertTrue(n2.compareTo(n2) == 0);
-		assertTrue(n2.compareTo(n3) &lt; 0);
-		assertTrue(n2.compareTo(n4) &lt; 0);
-		assertTrue(n3.compareTo(n1) &gt; 0);
-		assertTrue(n3.compareTo(n2) &gt; 0);
-		assertTrue(n3.compareTo(n3) == 0);
-		assertTrue(n3.compareTo(n4) == 0);
-		assertTrue(n4.compareTo(n1) &gt; 0);
-		assertTrue(n4.compareTo(n2) &gt; 0);
-		assertTrue(n4.compareTo(n3) == 0);
-		assertTrue(n4.compareTo(n4) == 0);
-	}
-
-	public void testShift() {
-		UnsignedShort n = new UnsignedShort(0x01);
-
-		n.shiftLeft(8);
-		assertEquals(0x100, n.intValue());
-		n.shiftLeft(7);
-		assertEquals(0x8000, n.intValue());
-		n.shiftRight(14);
-		assertEquals(0x02, n.intValue());
-
-		n = new UnsignedShort(0xACL);
-		n.shiftLeft(8);
-		assertEquals(0xAC00, n.intValue());
-		n.shiftRight(12);
-		assertEquals(0xA, n.intValue());
-	}
+public class UnsignedShortTest
+{
+    @Test()
+    public void test1()
+    {
+        UnsignedShort n = new UnsignedShort( 0xFFFF );
+        
+        assertEquals( (short) 0xFFFF, n.shortValue() );
+        assertEquals( 0xFFFF, n.intValue() );
+        assertEquals( 0xFFFFL, n.longValue() );
+        assertEquals( &quot;FFFF&quot;, n.toHexString() );
+        assertEquals( &quot;65535&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test2()
+    {
+        UnsignedShort n = new UnsignedShort( 0xFFFFL );
+        
+        assertEquals( (short) 0xFFFF, n.shortValue() );
+        assertEquals( 0xFFFF, n.intValue() );
+        assertEquals( 0xFFFFL, n.longValue() );
+        assertEquals( &quot;FFFF&quot;, n.toHexString() );
+        assertEquals( &quot;65535&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+        
+    }
+    
+    @Test()
+    public void test3()
+    {
+        UnsignedShort n = UnsignedShort.fromString( &quot;FFFF&quot;, 16 );
+        
+        assertEquals( (short) 0xFFFF, n.shortValue() );
+        assertEquals( 0xFFFF, n.intValue() );
+        assertEquals( 0xFFFFL, n.longValue() );
+        assertEquals( &quot;FFFF&quot;, n.toHexString() );
+        assertEquals( &quot;65535&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test4()
+    {
+        UnsignedShort n = UnsignedShort.fromString( &quot;65535&quot; );
+        
+        assertEquals( (short) 0xFFFF, n.shortValue() );
+        assertEquals( 0xFFFF, n.intValue() );
+        assertEquals( 0xFFFFL, n.longValue() );
+        assertEquals( &quot;FFFF&quot;, n.toHexString() );
+        assertEquals( &quot;65535&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test5()
+    {
+        UnsignedShort n =
+                UnsignedShort.fromBytes( new byte[] { (byte) 0xFF, (byte) 0xFF } );
+        
+        assertEquals( (short) 0xFFFF, n.shortValue() );
+        assertEquals( 0xFFFF, n.intValue() );
+        assertEquals( 0xFFFFL, n.longValue() );
+        assertEquals( &quot;FFFF&quot;, n.toHexString() );
+        assertEquals( &quot;65535&quot;, n.toString() );
+        assertTrue( Arrays.equals( new byte[] { (byte) 0xFF, (byte) 0xFF },
+                                   n.getBytes() ) );
+    }
+    
+    @Test()
+    public void test6()
+    {
+        UnsignedShort n1 = new UnsignedShort( 0 );
+        UnsignedShort n2 = new UnsignedShort( 0xFF );
+        UnsignedShort n3 = new UnsignedShort( 0xFFFFL );
+        UnsignedShort n4 =
+                UnsignedShort.fromBytes( new byte[] { (byte) 0xFF, (byte) 0xFF } );
+        
+        assertTrue( n1.compareTo( n1 ) == 0 );
+        assertTrue( n1.compareTo( n2 ) &lt; 0 );
+        assertTrue( n1.compareTo( n3 ) &lt; 0 );
+        assertTrue( n1.compareTo( n4 ) &lt; 0 );
+        assertTrue( n2.compareTo( n1 ) &gt; 0 );
+        assertTrue( n2.compareTo( n2 ) == 0 );
+        assertTrue( n2.compareTo( n3 ) &lt; 0 );
+        assertTrue( n2.compareTo( n4 ) &lt; 0 );
+        assertTrue( n3.compareTo( n1 ) &gt; 0 );
+        assertTrue( n3.compareTo( n2 ) &gt; 0 );
+        assertTrue( n3.compareTo( n3 ) == 0 );
+        assertTrue( n3.compareTo( n4 ) == 0 );
+        assertTrue( n4.compareTo( n1 ) &gt; 0 );
+        assertTrue( n4.compareTo( n2 ) &gt; 0 );
+        assertTrue( n4.compareTo( n3 ) == 0 );
+        assertTrue( n4.compareTo( n4 ) == 0 );
+    }
+    
+    @Test()
+    public void testShift()
+    {
+        UnsignedShort n = new UnsignedShort( 0x01 );
+        
+        n.shiftLeft( 8 );
+        assertEquals( 0x100, n.intValue() );
+        n.shiftLeft( 7 );
+        assertEquals( 0x8000, n.intValue() );
+        n.shiftRight( 14 );
+        assertEquals( 0x02, n.intValue() );
+        
+        n = new UnsignedShort( 0xACL );
+        n.shiftLeft( 8 );
+        assertEquals( 0xAC00, n.intValue() );
+        n.shiftRight( 12 );
+        assertEquals( 0xA, n.intValue() );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/BufferUtils.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/BufferUtils.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/BufferUtils.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -13,92 +13,117 @@
 
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- *
+ * 
  */
-public class BufferUtils {
-
-	/**
-	 * 
-	 */
-	private BufferUtils() {
-	}
-
-	public static ByteBuffer loadBuffer(String fName) throws IOException {
-		ByteBuffer buffer = ByteBuffer.allocate(16);
-		
-		buffer.setAutoExpand(true);
-
-		File baseDir = new File(System.getProperty(&quot;basedir&quot;));
-		File packetDump = new File(baseDir, 	&quot;src/test/resources/rtspproxy/rdt/&quot; + fName);
-
-		buffer = ByteBuffer.allocate(32); 
-		buffer.setAutoExpand(true);
-		
-		LineNumberReader lnr = new LineNumberReader(new InputStreamReader(
-				new FileInputStream(packetDump)));
-		String line;
-
-		while ((line = lnr.readLine()) != null) {
-			int pos = 0;
-			int nibblePos = 0;
-			byte b = 0;
-
-			for (pos = 0; pos &lt; line.length(); ++pos) {
-				char c = line.charAt(pos);
-				if (!Character.isWhitespace(c)) {
-					byte n = 0;
-
-					if (c &gt;= '0' &amp;&amp; c &lt;= '9') {
-						n = (byte) (c - '0');
-					} else if (c &gt;= 'a' &amp;&amp; c &lt;= 'f') {
-						n = (byte) (c - 'a' + 10);
-					} else if (c &gt;= 'A' &amp;&amp; c &lt;= 'F') {
-						n = (byte) (c - 'A' + 10);
-					} else
-						throw new IllegalArgumentException(
-								&quot;invalid character '&quot; + c + &quot;' in packet dump&quot;);
-					if (nibblePos == 0) {
-						b = (byte)(n &lt;&lt; 4);
-						nibblePos++;
-					} else {
-						b |= n;
-						nibblePos = 0;
-						buffer.put(b);
-					}
-				}
-			}
-		}
-		buffer.limit(buffer.position());
-		
-		return buffer;
-	}
-	
-	/**
-	 * compare two buffers for equality
-	 */
-	public static final boolean buffersEqual(ByteBuffer first, ByteBuffer second) {
-		boolean equal = false;
-		
-		/*
-		System.out.println(&quot;first limit=&quot; + first.limit() + &quot;, second limit=&quot; + second.limit());
-		*/
-		if(first.limit() == second.limit()) {
-			int i;
-			
-			for(i=0; i&lt;first.limit(); ++i) {
-				if(first.get(i) != second.get(i)) {
-					/*
-					System.out.println(&quot;index &quot; + i + &quot;: expected=&quot; + Integer.toHexString(first.get(i))
-							+ &quot;: got=&quot; + Integer.toHexString(second.get(i)));
-							*/
-					break;
-				}
-			}
-
-			if(i == first.limit())
-				equal = true;
-		}
-		
-		return equal;
-	}
+public class BufferUtils
+{
+    
+    /**
+     * 
+     */
+    private BufferUtils()
+    {
+    }
+    
+    public static ByteBuffer loadBuffer( String fName ) throws IOException
+    {
+        ByteBuffer buffer = ByteBuffer.allocate( 16 );
+        
+        buffer.setAutoExpand( true );
+        
+        String dir = System.getProperty( &quot;basedir&quot; );
+        if ( dir == null ) dir = System.getProperty( &quot;user.dir&quot; );
+        
+        File baseDir = new File( dir );
+        File packetDump =
+                new File( baseDir, &quot;src/test/resources/rtspproxy/rdt/&quot; + fName );
+        
+        buffer = ByteBuffer.allocate( 32 );
+        buffer.setAutoExpand( true );
+        
+        LineNumberReader lnr =
+                new LineNumberReader( new InputStreamReader(
+                        new FileInputStream( packetDump ) ) );
+        String line;
+        
+        while ( (line = lnr.readLine()) != null )
+        {
+            int pos = 0;
+            int nibblePos = 0;
+            byte b = 0;
+            
+            for ( pos = 0; pos &lt; line.length(); ++pos )
+            {
+                char c = line.charAt( pos );
+                if ( !Character.isWhitespace( c ) )
+                {
+                    byte n = 0;
+                    
+                    if ( c &gt;= '0' &amp;&amp; c &lt;= '9' )
+                    {
+                        n = (byte) (c - '0');
+                    }
+                    else if ( c &gt;= 'a' &amp;&amp; c &lt;= 'f' )
+                    {
+                        n = (byte) (c - 'a' + 10);
+                    }
+                    else if ( c &gt;= 'A' &amp;&amp; c &lt;= 'F' )
+                    {
+                        n = (byte) (c - 'A' + 10);
+                    }
+                    else throw new IllegalArgumentException(
+                            &quot;invalid character '&quot; + c + &quot;' in packet dump&quot; );
+                    if ( nibblePos == 0 )
+                    {
+                        b = (byte) (n &lt;&lt; 4);
+                        nibblePos++;
+                    }
+                    else
+                    {
+                        b |= n;
+                        nibblePos = 0;
+                        buffer.put( b );
+                    }
+                }
+            }
+        }
+        buffer.limit( buffer.position() );
+        
+        return buffer;
+    }
+    
+    /**
+     * compare two buffers for equality
+     */
+    public static final boolean buffersEqual( ByteBuffer first,
+            ByteBuffer second )
+    {
+        boolean equal = false;
+        
+        /*
+         * System.out.println(&quot;first limit=&quot; + first.limit() + &quot;, second limit=&quot; +
+         * second.limit());
+         */
+        if ( first.limit() == second.limit() )
+        {
+            int i;
+            
+            for ( i = 0; i &lt; first.limit(); ++i )
+            {
+                if ( first.get( i ) != second.get( i ) )
+                {
+                    /*
+                     * System.out.println(&quot;index &quot; + i + &quot;: expected=&quot; +
+                     * Integer.toHexString(first.get(i)) + &quot;: got=&quot; +
+                     * Integer.toHexString(second.get(i)));
+                     */
+                    break;
+                }
+            }
+            
+            if ( i == first.limit() ) equal = true;
+        }
+        
+        return equal;
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtAckPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtAckPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtAckPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -6,26 +6,34 @@
 import java.io.IOException;
 
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
 
-import junit.framework.TestCase;
-
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- *
+ * 
  */
-public class RdtAckPacketTest extends TestCase {
-
-	public void testRdtAckPacketLoad() throws IOException {
-		RdtAckPacket packet = (RdtAckPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtAckPacket.txt&quot;));
-		
-		assertEquals(packet.isLengthIncluded(), false);
-		assertEquals(packet.isLostHigh(), false);
-	}
-	
-	public void testRdtAckPacketSave() throws IOException {
-		ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtAckPacket.txt&quot;);
-		RdtAckPacket packet = (RdtAckPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtAckPacket.txt&quot;));
-		
-		assertTrue(BufferUtils.buffersEqual(buffer, packet.toByteBuffer()));
-	}
+public class RdtAckPacketTest
+{
+    
+    @Test()
+    public void testRdtAckPacketLoad() throws IOException
+    {
+        RdtAckPacket packet =
+                (RdtAckPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtAckPacket.txt&quot; ) );
+        
+        assertEquals( packet.isLengthIncluded(), false );
+        assertEquals( packet.isLostHigh(), false );
+    }
+    
+    @Test()
+    public void testRdtAckPacketSave() throws IOException
+    {
+        ByteBuffer buffer = BufferUtils.loadBuffer( &quot;RdtAckPacket.txt&quot; );
+        RdtAckPacket packet =
+                (RdtAckPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtAckPacket.txt&quot; ) );
+        
+        assertTrue( BufferUtils.buffersEqual( buffer, packet.toByteBuffer() ) );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtDataPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtDataPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtDataPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -3,92 +3,116 @@
  */
 package rtspproxy.rdt;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.io.IOException;
 
-import junit.framework.TestCase;
-
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
- *
+ * 
  */
-public class RdtDataPacketTest extends TestCase {
-
-	public void testRdtPacketStream0Load() throws IOException {
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketStream0.txt&quot;));
-		
-		assertEquals(packet.isNeedReliable(), true);
-		assertEquals(packet.getStreamId(), 0);
-		assertEquals(packet.isReliable(), false);
-		assertEquals(packet.getSequence(), 1438);
-		assertEquals(packet.isBackToBack(), false);
-		assertEquals(packet.isSlowData(), false);
-		assertEquals(packet.getAsmRule(), 1);
-		assertEquals(packet.getTimestamp(), 23993);
-		assertEquals(packet.getTotalReliable(), 0);
-	}
-	
-	public void testRdtPacketStream0Save() throws IOException {
-		ByteBuffer origBuffer = BufferUtils.loadBuffer(&quot;RdtDataPacketStream0.txt&quot;);
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketStream0.txt&quot;));
-
-		assertTrue(BufferUtils.buffersEqual(origBuffer, packet.toByteBuffer()));
-	}
-
-	public void testRdtPacketStream1Load() throws IOException {
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketStream1.txt&quot;));
-		
-		assertEquals(packet.isNeedReliable(), true);
-		assertEquals(packet.getStreamId(), 1);
-		assertEquals(packet.isReliable(), false);
-		assertEquals(packet.getSequence(), 3);
-		assertEquals(packet.isBackToBack(), false);
-		assertEquals(packet.isSlowData(), false);
-		assertEquals(packet.getAsmRule(), 1);
-		assertEquals(packet.getTimestamp(), 348);
-		assertEquals(packet.getTotalReliable(), 0);
-	}
-	
-	public void testRdtPacketStream1Save() throws IOException {
-		ByteBuffer origBuffer = BufferUtils.loadBuffer(&quot;RdtDataPacketStream1.txt&quot;);
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketStream1.txt&quot;));
-
-		assertTrue(BufferUtils.buffersEqual(origBuffer, packet.toByteBuffer()));
-	}
-
-	public void testRdtPacketBackToBackLoad() throws IOException {
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketDataPacket.txt&quot;));
-		RdtDataPacket subPacket = (RdtDataPacket)packet.getSubPacket();
-		
-		// packet 0
-		assertEquals(packet.isNeedReliable(), true);
-		assertEquals(packet.getStreamId(), 0);
-		assertEquals(packet.isReliable(), false);
-		assertEquals(packet.getSequence(), 1);
-		assertEquals(packet.isBackToBack(), false);
-		assertEquals(packet.isSlowData(), true);
-		assertEquals(packet.getAsmRule(), 0);
-		assertEquals(packet.getTimestamp(), 0);
-		assertEquals(packet.getTotalReliable(), 0);
-		assertEquals(packet.getPayload().length, 145);
-		
-		assertEquals(subPacket.isNeedReliable(), true);
-		assertEquals(subPacket.getStreamId(), 0);
-		assertEquals(subPacket.isReliable(), false);
-		assertEquals(subPacket.getSequence(), 2);
-		assertEquals(subPacket.isBackToBack(), false);
-		assertEquals(subPacket.isSlowData(), true);
-		assertEquals(subPacket.getAsmRule(), 0);
-		assertEquals(subPacket.getTimestamp(), 266);
-		assertEquals(subPacket.getTotalReliable(), 0);
-		assertEquals(subPacket.getPayload().length, 127);		
-	}
-	
-	public void testRdtPacketBackToBackSave() throws IOException {
-		ByteBuffer origBuffer = BufferUtils.loadBuffer(&quot;RdtDataPacketDataPacket.txt&quot;);
-		RdtDataPacket packet = (RdtDataPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtDataPacketDataPacket.txt&quot;));
-
-		assertTrue(BufferUtils.buffersEqual(origBuffer, packet.toByteBuffer()));
-	}
+public class RdtDataPacketTest
+{
+    
+    @Test()
+    public void testRdtPacketStream0Load() throws IOException
+    {
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketStream0.txt&quot; ) );
+        
+        assertEquals( packet.isNeedReliable(), true );
+        assertEquals( packet.getStreamId(), 0 );
+        assertEquals( packet.isReliable(), false );
+        assertEquals( packet.getSequence(), 1438 );
+        assertEquals( packet.isBackToBack(), false );
+        assertEquals( packet.isSlowData(), false );
+        assertEquals( packet.getAsmRule(), 1 );
+        assertEquals( packet.getTimestamp(), 23993 );
+        assertEquals( packet.getTotalReliable(), 0 );
+    }
+    
+    @Test()
+    public void testRdtPacketStream0Save() throws IOException
+    {
+        ByteBuffer origBuffer =
+                BufferUtils.loadBuffer( &quot;RdtDataPacketStream0.txt&quot; );
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketStream0.txt&quot; ) );
+        
+        assertTrue( BufferUtils.buffersEqual( origBuffer, packet.toByteBuffer() ) );
+    }
+    
+    @Test()
+    public void testRdtPacketStream1Load() throws IOException
+    {
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketStream1.txt&quot; ) );
+        
+        assertEquals( packet.isNeedReliable(), true );
+        assertEquals( packet.getStreamId(), 1 );
+        assertEquals( packet.isReliable(), false );
+        assertEquals( packet.getSequence(), 3 );
+        assertEquals( packet.isBackToBack(), false );
+        assertEquals( packet.isSlowData(), false );
+        assertEquals( packet.getAsmRule(), 1 );
+        assertEquals( packet.getTimestamp(), 348 );
+        assertEquals( packet.getTotalReliable(), 0 );
+    }
+    
+    @Test()
+    public void testRdtPacketStream1Save() throws IOException
+    {
+        ByteBuffer origBuffer =
+                BufferUtils.loadBuffer( &quot;RdtDataPacketStream1.txt&quot; );
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketStream1.txt&quot; ) );
+        
+        assertTrue( BufferUtils.buffersEqual( origBuffer, packet.toByteBuffer() ) );
+    }
+    
+    @Test()
+    public void testRdtPacketBackToBackLoad() throws IOException
+    {
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketDataPacket.txt&quot; ) );
+        RdtDataPacket subPacket = (RdtDataPacket) packet.getSubPacket();
+        
+        // packet 0
+        assertEquals( packet.isNeedReliable(), true );
+        assertEquals( packet.getStreamId(), 0 );
+        assertEquals( packet.isReliable(), false );
+        assertEquals( packet.getSequence(), 1 );
+        assertEquals( packet.isBackToBack(), false );
+        assertEquals( packet.isSlowData(), true );
+        assertEquals( packet.getAsmRule(), 0 );
+        assertEquals( packet.getTimestamp(), 0 );
+        assertEquals( packet.getTotalReliable(), 0 );
+        assertEquals( packet.getPayload().length, 145 );
+        
+        assertEquals( subPacket.isNeedReliable(), true );
+        assertEquals( subPacket.getStreamId(), 0 );
+        assertEquals( subPacket.isReliable(), false );
+        assertEquals( subPacket.getSequence(), 2 );
+        assertEquals( subPacket.isBackToBack(), false );
+        assertEquals( subPacket.isSlowData(), true );
+        assertEquals( subPacket.getAsmRule(), 0 );
+        assertEquals( subPacket.getTimestamp(), 266 );
+        assertEquals( subPacket.getTotalReliable(), 0 );
+        assertEquals( subPacket.getPayload().length, 127 );
+    }
+    
+    @Test()
+    public void testRdtPacketBackToBackSave() throws IOException
+    {
+        ByteBuffer origBuffer =
+                BufferUtils.loadBuffer( &quot;RdtDataPacketDataPacket.txt&quot; );
+        RdtDataPacket packet =
+                (RdtDataPacket) RdtPacketDecoder.decode( BufferUtils.loadBuffer( &quot;RdtDataPacketDataPacket.txt&quot; ) );
+        
+        assertTrue( BufferUtils.buffersEqual( origBuffer, packet.toByteBuffer() ) );
+    }
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtLatencyRepostPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtLatencyRepostPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtLatencyRepostPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -2,28 +2,30 @@
  * 
  */
 package rtspproxy.rdt;
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
 
-
 import java.io.IOException;
 
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
-import junit.framework.TestCase;
-
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  *
  */
-public class RdtLatencyRepostPacketTest extends TestCase {
+public class RdtLatencyRepostPacketTest {
 
-	public void testRdtLatencyReportPacketLoad() throws IOException {
+	@Test()
+    public void testRdtLatencyReportPacketLoad() throws IOException {
 		RdtLatencyReportPacket packet = (RdtLatencyReportPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtLatencyReportWithDataPacket.txt&quot;));
 		
 		assertEquals(packet.isLengthIncluded(), true);
 		assertEquals(packet.getServerTimeout(), 0);
 	}
 
-	public void testRdtLatencyReportPacketDataLoad() throws IOException {
+	@Test()
+    public void testRdtLatencyReportPacketDataLoad() throws IOException {
 		RdtLatencyReportPacket packet = (RdtLatencyReportPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtLatencyReportWithDataPacket.txt&quot;));
 		
 		assertEquals(packet.isLengthIncluded(), true);
@@ -42,7 +44,8 @@
 		assertEquals(subPacket.getTotalReliable(), 0);
 	}
 
-	public void testRdtLatencyReportPacketSave() throws IOException {
+	@Test()
+    public void testRdtLatencyReportPacketSave() throws IOException {
 		ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtLatencyReportWithDataPacket.txt&quot;);
 		RdtLatencyReportPacket packet = (RdtLatencyReportPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtLatencyReportWithDataPacket.txt&quot;));
 		

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttRequestPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttRequestPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttRequestPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -3,26 +3,30 @@
  */
 package rtspproxy.rdt;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.io.IOException;
 
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
-import junit.framework.TestCase;
-
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  *
  */
-public class RdtRttRequestPacketTest extends TestCase {
+public class RdtRttRequestPacketTest {
 
-	public void testRdtRttRequestPacketLoad() throws IOException {
+	@Test()
+    public void testRdtRttRequestPacketLoad() throws IOException {
 		RdtRttRequestPacket packet = 
 			(RdtRttRequestPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtRttRequestPacket.txt&quot;));
 		
 		assertEquals(packet.isLengthIncluded(), false);
 	}
 
-	public void testRdtRttRequestPacketSave() throws IOException {
+	@Test()
+    public void testRdtRttRequestPacketSave() throws IOException {
 		ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtRttRequestPacket.txt&quot;);
 		RdtRttRequestPacket packet = 
 			(RdtRttRequestPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtRttRequestPacket.txt&quot;));

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttResponsePacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttResponsePacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtRttResponsePacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -3,20 +3,23 @@
  */
 package rtspproxy.rdt;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.io.IOException;
 
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
-import junit.framework.TestCase;
-
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  *
  */
-public class RdtRttResponsePacketTest extends TestCase {
+public class RdtRttResponsePacketTest {
 
 
-	public void testRdtRttResponsePacketLoad() throws IOException {
+	@Test()
+    public void testRdtRttResponsePacketLoad() throws IOException {
 		RdtRttResponsePacket packet = (RdtRttResponsePacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtRttResponsePacket.txt&quot;));
 
 		assertEquals(packet.isLengthIncluded(), false);
@@ -24,7 +27,8 @@
 		assertEquals(packet.getRoundtripTimestampMicroseconds(), 101211);
 	}
 	
-	public void testRdtRttResponsePacketSave() throws IOException {
+	@Test()
+    public void testRdtRttResponsePacketSave() throws IOException {
 		ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtRttResponsePacket.txt&quot;);
 		RdtRttResponsePacket packet = (RdtRttResponsePacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtRttResponsePacket.txt&quot;));
 		

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtStreamEndPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtStreamEndPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rdt/RdtStreamEndPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -3,19 +3,22 @@
  */
 package rtspproxy.rdt;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.io.IOException;
 
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
-import junit.framework.TestCase;
-
 /**
  * @author Rainer Bieniek (<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>)
  *
  */
-public class RdtStreamEndPacketTest extends TestCase {
+public class RdtStreamEndPacketTest {
 
-		public void testRdtStreamEndPacketStream0Load() throws IOException {
+		@Test()
+        public void testRdtStreamEndPacketStream0Load() throws IOException {
 			RdtStreamEndPacket packet = (RdtStreamEndPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream0.txt&quot;));
 			
 			assertEquals(packet.isNeedReliable(), true);
@@ -27,7 +30,8 @@
 			assertEquals(packet.getTotalReliable(), 0);
 		}
 		
-		public void testRdtStreamEndPacketStream0Save() throws IOException {
+		@Test()
+        public void testRdtStreamEndPacketStream0Save() throws IOException {
 			ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream0.txt&quot;);
 			RdtStreamEndPacket packet = (RdtStreamEndPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream0.txt&quot;));
 	
@@ -35,7 +39,8 @@
 		}
 
 
-		public void testRdtStreamEndPacketStream1Load() throws IOException {
+		@Test()
+        public void testRdtStreamEndPacketStream1Load() throws IOException {
 			RdtStreamEndPacket packet = (RdtStreamEndPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream1.txt&quot;));
 			
 			assertEquals(packet.isNeedReliable(), true);
@@ -47,7 +52,8 @@
 			assertEquals(packet.getTotalReliable(), 0);
 		}
 		
-		public void testRdtStreamEndPacketStream1Save() throws IOException {
+		@Test()
+        public void testRdtStreamEndPacketStream1Save() throws IOException {
 			ByteBuffer buffer = BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream1.txt&quot;);
 			RdtStreamEndPacket packet = (RdtStreamEndPacket)RdtPacketDecoder.decode(BufferUtils.loadBuffer(&quot;RdtStreamEndPacketStream1.txt&quot;));
 	

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/RtpPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/RtpPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/RtpPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -18,11 +18,13 @@
 
 package rtspproxy.rtp;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
-
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
 import rtspproxy.lib.number.UnsignedByte;
 import rtspproxy.lib.number.UnsignedInt;
@@ -31,13 +33,10 @@
 /**
  * @author mat
  */
-public class RtpPacketTest extends TestCase {
+public class RtpPacketTest {
 
-	public static void main(String[] args) {
-		junit.textui.TestRunner.run(RtpPacketTest.class);
-	}
-
-	public void testRtpPacket() {
+	@Test()
+    public void testRtpPacket() {
 		// Set the values
 		byte version = 2;
 		boolean padding = true;

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp/RtcpPacketTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp/RtcpPacketTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtp/rtcp/RtcpPacketTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -18,30 +18,27 @@
 
 package rtspproxy.rtp.rtcp;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.Assert;
-import junit.framework.TestCase;
-
 import org.apache.mina.common.ByteBuffer;
+import org.testng.annotations.Test;
 
 import rtspproxy.lib.number.UnsignedInt;
 
 /**
  * @author mat
  */
-public class RtcpPacketTest extends TestCase
+public class RtcpPacketTest
 {
 
-	public static void main( String[] args )
-	{
-		junit.textui.TestRunner.run( RtcpPacketTest.class );
-	}
-
-	/*
+    /*
 	 * Test method for 'rtspproxy.Config.get(String, String)'
 	 */
-	public void testRtcpPacket()
+	@Test
+    public void rtcpPacket()
 	{
 		/* Construct a new dummy packet */
 		RtcpPacket packet = new RtcpPacket();
@@ -60,14 +57,14 @@
 		/* Recreate a RtcpPacket from buffer */
 		RtcpPacket packet2 = new RtcpPacket( buffer );
 
-		/* Compare the two packets */
-		Assert.assertEquals( packet.version, packet2.version );
-		Assert.assertEquals( packet.padding, packet2.padding );
-		Assert.assertEquals( packet.count, packet2.count );
-		Assert.assertEquals( packet.packetType, packet2.packetType );
-		Assert.assertEquals( packet.length, packet2.length );
-		Assert.assertEquals( packet.ssrc, packet2.ssrc );
-		Assert.assertTrue( Arrays.equals( packet.packetBuffer, packet2.packetBuffer ) );
+        /* Compare the two packets */
+		assertEquals( packet.version, packet2.version );
+		assertEquals( packet.padding, packet2.padding );
+		assertEquals( packet.count, packet2.count );
+		assertEquals( packet.packetType, packet2.packetType );
+		assertEquals( packet.length, packet2.length );
+		assertEquals( packet.ssrc, packet2.ssrc );
+		assertTrue( Arrays.equals( packet.packetBuffer, packet2.packetBuffer ) );
 	}
 
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportListTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportListTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportListTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -18,45 +18,39 @@
 
 package rtspproxy.rtsp;
 
-import junit.framework.TestCase;
+import static org.testng.Assert.assertEquals;
 
+import org.testng.annotations.Test;
+
 /**
  * @author Matteo Merli
  */
-public class RtspTransportListTest extends TestCase
+public class RtspTransportListTest
 {
-
-	public static void main( String[] args )
-	{
-		junit.textui.TestRunner.run( RtspTransportListTest.class );
-	}
-
-	RtspTransportList transportList;
-	String transportTest;
-
-	@Override
-	protected void setUp() throws Exception
-	{
-		transportTest = &quot;x-real-rdt/mcast;client_port=6972;mode=play,&quot;
-				+ &quot;x-real-rdt/udp;client_port=6972;mode=play,&quot;
-				+ &quot;x-pn-tng/udp;client_port=6972;mode=play,&quot;
-				+ &quot;RTP/AVP;unicast;client_port=6972-6973;mode=play,&quot;
-				+ &quot;x-pn-tng/tcp;mode=play,&quot; + &quot;x-real-rdt/tcp;mode=play,&quot;
-				+ &quot;RTP/AVP/TCP;unicast;mode=play&quot;;
-		transportList = new RtspTransportList( transportTest );
-	}
-
-	public void testToString()
-	{
-		String expected = &quot;x-real-rdt/udp;client_port=6972;mode=\&quot;PLAY\&quot;,&quot;
-				+ &quot;RTP/AVP/UDP;unicast;client_port=6972-6973;mode=\&quot;PLAY\&quot;&quot;;
-		assertEquals( expected, transportList.toString() );
-	}
-
-	public void testCount()
-	{
-		// only a transport type is valid in this test
-		assertEquals( 2, transportList.count() );
-	}
-
+    String transportTest =
+            &quot;x-real-rdt/mcast;client_port=6972;mode=play,&quot;
+                    + &quot;x-real-rdt/udp;client_port=6972;mode=play,&quot;
+                    + &quot;x-pn-tng/udp;client_port=6972;mode=play,&quot;
+                    + &quot;RTP/AVP;unicast;client_port=6972-6973;mode=play,&quot;
+                    + &quot;x-pn-tng/tcp;mode=play,&quot; + &quot;x-real-rdt/tcp;mode=play,&quot;
+                    + &quot;RTP/AVP/TCP;unicast;mode=play&quot;;
+    
+    RtspTransportList transportList = new RtspTransportList( transportTest );
+    
+    @Test
+    public void ToString()
+    {
+        String expected =
+                &quot;x-real-rdt/udp;client_port=6972;mode=\&quot;PLAY\&quot;,&quot;
+                        + &quot;RTP/AVP/UDP;unicast;client_port=6972-6973;mode=\&quot;PLAY\&quot;&quot;;
+        assertEquals( expected, transportList.toString() );
+    }
+    
+    @Test
+    public void count()
+    {
+        // only a transport type is valid in this test
+        assertEquals( 2, transportList.count() );
+    }
+    
 }

Modified: trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportTest.java
===================================================================
--- trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportTest.java	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/src/test/java/rtspproxy/rtsp/RtspTransportTest.java	2007-05-02 16:31:26 UTC (rev 437)
@@ -18,302 +18,337 @@
 
 package rtspproxy.rtsp;
 
+import static org.testng.Assert.assertEquals;
+import static org.testng.Assert.assertTrue;
+
 import java.util.Arrays;
 
-import junit.framework.TestCase;
+import org.testng.annotations.Configuration;
+import org.testng.annotations.Test;
+
 import rtspproxy.rtsp.RtspTransport.DeliveryType;
 
 /**
  * @author Matteo Merli
  */
-public class RtspTransportTest extends TestCase
+public class RtspTransportTest
 {
-
-	public static void main( String[] args )
-	{
-		junit.textui.TestRunner.run( RtspTransportTest.class );
-	}
-
-	String test1 = &quot;x-real-rdt/mcast;client_port=6972;mode=play&quot;;
-	String test2 = &quot;x-real-rdt/udp;client_port=6972;mode=play&quot;;
-	String test3 = &quot;x-pn-tng/udp;client_port=6972;mode=play&quot;;
-	String test4 = &quot;RTP/AVP;unicast;client_port=6972-6973;mode=play&quot;;
-	String test5 = &quot;x-pn-tng/tcp;mode=play&quot;;
-	String test6 = &quot;x-real-rdt/tcp;mode=play&quot;;
-	String test7 = &quot;RTP/AVP/TCP;unicast;mode=play&quot;;
+    String test1 = &quot;x-real-rdt/mcast;client_port=6972;mode=play&quot;;   
+    String test2 = &quot;x-real-rdt/udp;client_port=6972;mode=play&quot;;
+    String test3 = &quot;x-pn-tng/udp;client_port=6972;mode=play&quot;;
+    String test4 = &quot;RTP/AVP;unicast;client_port=6972-6973;mode=play&quot;;
+    String test5 = &quot;x-pn-tng/tcp;mode=play&quot;;
+    String test6 = &quot;x-real-rdt/tcp;mode=play&quot;;
+    String test7 = &quot;RTP/AVP/TCP;unicast;mode=play&quot;;
     String test8 = &quot;RTP/AVP/TCP;UNICAST;mode=play&quot;;
 
-	RtspTransport transport1;
-	RtspTransport transport2;
-	RtspTransport transport3;
-	RtspTransport transport4;
-	RtspTransport transport5;
-	RtspTransport transport6;
-	RtspTransport transport7;
+    RtspTransport transport1;
+    RtspTransport transport2;
+    RtspTransport transport3;
+    RtspTransport transport4;
+    RtspTransport transport5;
+    RtspTransport transport6;
+    RtspTransport transport7;
     RtspTransport transport8;
-
-	@Override
-	protected void setUp() throws Exception
-	{
-		transport1 = new RtspTransport( test1 );
-		transport2 = new RtspTransport( test2 );
-		transport3 = new RtspTransport( test3 );
-		transport4 = new RtspTransport( test4 );
-		transport5 = new RtspTransport( test5 );
-		transport6 = new RtspTransport( test6 );
-		transport7 = new RtspTransport( test7 );
+    
+    @Configuration(beforeTestMethod = true)
+    protected void setUp() throws Exception
+    {
+        transport1 = new RtspTransport( test1 );
+        transport2 = new RtspTransport( test2 );
+        transport3 = new RtspTransport( test3 );
+        transport4 = new RtspTransport( test4 );
+        transport5 = new RtspTransport( test5 );
+        transport6 = new RtspTransport( test6 );
+        transport7 = new RtspTransport( test7 );
         transport8 = new RtspTransport( test8 );
-	}
-
-	public void testIsSupportedByProxy()
-	{
-		assertEquals( false, transport1.isSupportedByProxy() );
-		assertEquals( true, transport2.isSupportedByProxy() );
-		assertEquals( false, transport3.isSupportedByProxy() );
-		assertEquals( true, transport4.isSupportedByProxy() );
-		assertEquals( false, transport5.isSupportedByProxy() );
-		assertEquals( false, transport6.isSupportedByProxy() );
-		assertEquals( false, transport7.isSupportedByProxy() );
+    }
+    
+    @Test()
+    public void isSupportedByProxy()
+    {
+        assertEquals( false, transport1.isSupportedByProxy() );
+        assertEquals( true, transport2.isSupportedByProxy() );
+        assertEquals( false, transport3.isSupportedByProxy() );
+        assertEquals( true, transport4.isSupportedByProxy() );
+        assertEquals( false, transport5.isSupportedByProxy() );
+        assertEquals( false, transport6.isSupportedByProxy() );
+        assertEquals( false, transport7.isSupportedByProxy() );
         assertEquals( false, transport8.isSupportedByProxy() );
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.toString()'
-	 */
-	public void testToString()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.isAppend()'
-	 */
-	public void testIsAppend()
-	{
-		assertEquals( false, transport1.isAppend() );
-		assertEquals( false, transport2.isAppend() );
-		assertEquals( false, transport3.isAppend() );
-		assertEquals( false, transport4.isAppend() );
-		assertEquals( false, transport5.isAppend() );
-		assertEquals( false, transport6.isAppend() );
-		assertEquals( false, transport7.isAppend() );
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.toString()'
+     */
+    @Test()
+    public void testToString()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.isAppend()'
+     */
+    @Test()
+    public void isAppend()
+    {
+        assertEquals( false, transport1.isAppend() );
+        assertEquals( false, transport2.isAppend() );
+        assertEquals( false, transport3.isAppend() );
+        assertEquals( false, transport4.isAppend() );
+        assertEquals( false, transport5.isAppend() );
+        assertEquals( false, transport6.isAppend() );
+        assertEquals( false, transport7.isAppend() );
         assertEquals( false, transport8.isAppend() );
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getClientPort()'
-	 */
-	public void testGetClientPort()
-	{
-		assertTrue( Arrays.equals( new int[] { 6972, 0 }, transport1.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 6972, 0 }, transport2.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 6972, 0 }, transport3.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 6972, 6973 }, transport4.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 0, 0 }, transport5.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 0, 0 }, transport6.getClientPort() ) );
-		assertTrue( Arrays.equals( new int[] { 0, 0 }, transport7.getClientPort() ) );
-        assertTrue( Arrays.equals( new int[] { 0, 0 }, transport8.getClientPort() ) );
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getDeliveryType()'
-	 */
-	public void testGetDeliveryType()
-	{
-		assertEquals( DeliveryType.unicast, transport1.getDeliveryType() );
-		assertEquals( DeliveryType.unicast, transport2.getDeliveryType() );
-		assertEquals( DeliveryType.None, transport3.getDeliveryType() );
-		assertEquals( DeliveryType.unicast, transport4.getDeliveryType() );
-		assertEquals( DeliveryType.None, transport5.getDeliveryType() );
-		assertEquals( DeliveryType.unicast, transport6.getDeliveryType() );
-		assertEquals( DeliveryType.unicast, transport7.getDeliveryType() );
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getClientPort()'
+     */
+    @Test()
+    public void testGetClientPort()
+    {
+        assertTrue( Arrays.equals( new int[] { 6972, 0 },
+                                   transport1.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 6972, 0 },
+                                   transport2.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 6972, 0 },
+                                   transport3.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 6972, 6973 },
+                                   transport4.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 0, 0 },
+                                   transport5.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 0, 0 },
+                                   transport6.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 0, 0 },
+                                   transport7.getClientPort() ) );
+        assertTrue( Arrays.equals( new int[] { 0, 0 },
+                                   transport8.getClientPort() ) );
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getDeliveryType()'
+     */
+    @Test()
+    public void testGetDeliveryType()
+    {
+        assertEquals( DeliveryType.unicast, transport1.getDeliveryType() );
+        assertEquals( DeliveryType.unicast, transport2.getDeliveryType() );
+        assertEquals( DeliveryType.None, transport3.getDeliveryType() );
+        assertEquals( DeliveryType.unicast, transport4.getDeliveryType() );
+        assertEquals( DeliveryType.None, transport5.getDeliveryType() );
+        assertEquals( DeliveryType.unicast, transport6.getDeliveryType() );
+        assertEquals( DeliveryType.unicast, transport7.getDeliveryType() );
         assertEquals( DeliveryType.unicast, transport8.getDeliveryType() );
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getInterleaved()'
-	 */
-	public void testGetInterleaved()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setInterleaved(String)'
-	 */
-	public void testSetInterleaved()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getLayers()'
-	 */
-	public void testGetLayers()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setLayers(int)'
-	 */
-	public void testSetLayers()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getLowerTransport()'
-	 */
-	public void testGetLowerTransport()
-	{
-
-	}
-
-	/*
-	 * Test method for
-	 * 'rtspproxy.rtsp.RtspTransport.setLowerTransport(LowerTransport)'
-	 */
-	public void testSetLowerTransport()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getMode()'
-	 */
-	public void testGetMode()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setMode(String)'
-	 */
-	public void testSetMode()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getPort()'
-	 */
-	public void testGetPort()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setPort(int[])'
-	 */
-	public void testSetPort()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getProfile()'
-	 */
-	public void testGetProfile()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setProfile(Profile)'
-	 */
-	public void testSetProfile()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getServerPort()'
-	 */
-	public void testGetServerPort()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setServerPort(int[])'
-	 */
-	public void testSetServerPort()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getSSRC()'
-	 */
-	public void testGetSSRC()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setSSRC(String)'
-	 */
-	public void testSetSSRCString()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setSSRC(long)'
-	 */
-	public void testSetSSRCLong()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getTransportProtocol()'
-	 */
-	public void testGetTransportProtocol()
-	{
-
-	}
-
-	/*
-	 * Test method for
-	 * 'rtspproxy.rtsp.RtspTransport.setTransportProtocol(TransportProtocol)'
-	 */
-	public void testSetTransportProtocol()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getTTL()'
-	 */
-	public void testGetTTL()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setTTL(int)'
-	 */
-	public void testSetTTL()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.setSource(String)'
-	 */
-	public void testSetSource()
-	{
-
-	}
-
-	/*
-	 * Test method for 'rtspproxy.rtsp.RtspTransport.getSource()'
-	 */
-	public void testGetSource()
-	{
-
-	}
-
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getInterleaved()'
+     */
+    @Test()
+    public void testGetInterleaved()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setInterleaved(String)'
+     */
+    @Test()
+    public void testSetInterleaved()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getLayers()'
+     */
+    @Test()
+    public void testGetLayers()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setLayers(int)'
+     */
+    @Test()
+    public void testSetLayers()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getLowerTransport()'
+     */
+    @Test()
+    public void testGetLowerTransport()
+    {
+        
+    }
+    
+    /*
+     * Test method for
+     * 'rtspproxy.rtsp.RtspTransport.setLowerTransport(LowerTransport)'
+     */
+    @Test()
+    public void testSetLowerTransport()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getMode()'
+     */
+    @Test()
+    public void testGetMode()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setMode(String)'
+     */
+    @Test()
+    public void testSetMode()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getPort()'
+     */
+    @Test()
+    public void testGetPort()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setPort(int[])'
+     */
+    @Test()
+    public void testSetPort()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getProfile()'
+     */
+    @Test()
+    public void testGetProfile()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setProfile(Profile)'
+     */
+    @Test()
+    public void testSetProfile()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getServerPort()'
+     */
+    @Test()
+    public void testGetServerPort()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setServerPort(int[])'
+     */
+    @Test()
+    public void testSetServerPort()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getSSRC()'
+     */
+    @Test()
+    public void testGetSSRC()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setSSRC(String)'
+     */
+    @Test()
+    public void testSetSSRCString()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setSSRC(long)'
+     */
+    @Test()
+    public void testSetSSRCLong()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getTransportProtocol()'
+     */
+    @Test()
+    public void testGetTransportProtocol()
+    {
+        
+    }
+    
+    /*
+     * Test method for
+     * 'rtspproxy.rtsp.RtspTransport.setTransportProtocol(TransportProtocol)'
+     */
+    @Test()
+    public void testSetTransportProtocol()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getTTL()'
+     */
+    @Test()
+    public void testGetTTL()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setTTL(int)'
+     */
+    @Test()
+    public void testSetTTL()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.setSource(String)'
+     */
+    @Test()
+    public void testSetSource()
+    {
+        
+    }
+    
+    /*
+     * Test method for 'rtspproxy.rtsp.RtspTransport.getSource()'
+     */
+    @Test()
+    public void testGetSource()
+    {
+        
+    }
+    
 }

Added: trunk/RTSPProxy-Core/testng.xml
===================================================================
--- trunk/RTSPProxy-Core/testng.xml	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/RTSPProxy-Core/testng.xml	2007-05-02 16:31:26 UTC (rev 437)
@@ -0,0 +1,9 @@
+&lt;!DOCTYPE suite SYSTEM &quot;<A HREF="http://testng.org/testng-1.0.dtd">http://testng.org/testng-1.0.dtd</A>&quot; &gt;
+
+&lt;suite name=&quot;RtspProxy-Core Tests&quot; verbose=&quot;1&quot;&gt;
+	&lt;test name=&quot;ciao&quot;&gt;
+		&lt;packages&gt;
+			&lt;package name=&quot;rtspproxy.*&quot; /&gt;
+		&lt;/packages&gt;
+	&lt;/test&gt;
+&lt;/suite&gt;
\ No newline at end of file


Property changes on: trunk/RTSPProxy-Core/testng.xml
___________________________________________________________________
Name: svn:keywords
   + Id URL Rev


Property changes on: trunk/RTSPProxy-OSGi
___________________________________________________________________
Name: svn:ignore
   - 
target

   + target
pom.properties


Added: trunk/generateEclipseProjects.sh
===================================================================
--- trunk/generateEclipseProjects.sh	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/generateEclipseProjects.sh	2007-05-02 16:31:26 UTC (rev 437)
@@ -0,0 +1,3 @@
+#!/bin/sh
+
+mvn -Dwtpversion=1.5 eclipse:eclipse


Property changes on: trunk/generateEclipseProjects.sh
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + Id URL Rev

Modified: trunk/pom.xml
===================================================================
--- trunk/pom.xml	2006-10-12 19:26:48 UTC (rev 436)
+++ trunk/pom.xml	2007-05-02 16:31:26 UTC (rev 437)
@@ -1,331 +1,326 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
 &lt;project xsi:noNamespaceSchemaLocation=&quot;<A HREF="http://maven.apache.org/maven-v4_0_0.xsd">http://maven.apache.org/maven-v4_0_0.xsd</A>&quot;&gt;
-  
-  &lt;!-- 
-  $Id$
-  $URL$
-  --&gt;
-  
-  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
-  
-  &lt;name&gt;RTSP Proxy&lt;/name&gt;
-  &lt;groupId&gt;net.merlimat&lt;/groupId&gt;
-  &lt;artifactId&gt;rtspproxy&lt;/artifactId&gt;
-  &lt;packaging&gt;pom&lt;/packaging&gt;
-  &lt;version&gt;3.0-ALPHA5-SNAPSHOT&lt;/version&gt;
-  &lt;url&gt;<A HREF="http://rtspproxy.berlios.de&lt;/url">http://rtspproxy.berlios.de&lt;/url</A>&gt;
-  &lt;inceptionYear&gt;2003&lt;/inceptionYear&gt;
-  
-  &lt;organization&gt;
-    &lt;name&gt;Matteo Merli&lt;/name&gt;
-    &lt;url&gt;<A HREF="http://merlimat.net&lt;/url">http://merlimat.net&lt;/url</A>&gt;
-  &lt;/organization&gt;
-  
-  &lt;issueManagement&gt;
-    &lt;system&gt;Berlios&lt;/system&gt;
-    &lt;url&gt;<A HREF="http://developer.berlios.de/bugs/?group_id=4526&lt;/url">http://developer.berlios.de/bugs/?group_id=4526&lt;/url</A>&gt;
-  &lt;/issueManagement&gt;
-  
-  &lt;licenses&gt;
-    &lt;license&gt;
-      &lt;name&gt;GNU General Public License&lt;/name&gt;
-      &lt;url&gt;LICENSE.txt&lt;/url&gt;
-    &lt;/license&gt;
-  &lt;/licenses&gt;
 
-  &lt;developers&gt;
-    &lt;developer&gt;
-      &lt;id&gt;merlimat&lt;/id&gt;
-      &lt;name&gt;Matteo Merli&lt;/name&gt;
-      &lt;email&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">matteo.merli at gmail.com</A>&lt;/email&gt;
-      &lt;!-- &lt;timezone&gt;+1&lt;/timezone&gt; --&gt;
-      &lt;url&gt;<A HREF="http://merlimat.net/about&lt;/url">http://merlimat.net/about&lt;/url</A>&gt;
-    &lt;/developer&gt;
-    &lt;developer&gt;
-      &lt;id&gt;rbieniek&lt;/id&gt;
-      &lt;name&gt;Rainer Bieniek&lt;/name&gt;
-      &lt;email&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>&lt;/email&gt;
-      &lt;!-- &lt;timezone&gt;+1&lt;/timezone&gt; --&gt;
-      &lt;!-- &lt;url&gt;<A HREF="http://merlimat.net/about&lt;/url">http://merlimat.net/about&lt;/url</A>&gt; --&gt;
-    &lt;/developer&gt;
-  &lt;/developers&gt;
-  
-  &lt;scm&gt;
-    &lt;connection&gt;
-      scm:svn:<A HREF="http://svn.berlios.de/svnroot/repos/rtspproxy/trunk">http://svn.berlios.de/svnroot/repos/rtspproxy/trunk</A>
-    &lt;/connection&gt;
-    &lt;developerConnection&gt;
-      scm:svn:<A HREF="https://svn.berlios.de/svnroot/repos/rtspproxy/trunk">https://svn.berlios.de/svnroot/repos/rtspproxy/trunk</A>
-    &lt;/developerConnection&gt;
-    &lt;url&gt;<A HREF="http://svn.berlios.de/wsvn/rtspproxy/&lt;/url">http://svn.berlios.de/wsvn/rtspproxy/&lt;/url</A>&gt;
-  &lt;/scm&gt;
-  
-  &lt;mailingLists&gt;
-    &lt;mailingList&gt;
-      &lt;name&gt;Development list&lt;/name&gt;
-      &lt;post&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">rtspproxy-devel at lists.berlios.de</A>&lt;/post&gt;
-      
-      &lt;archive&gt;
-	<A HREF="http://www.nabble.com/RtspProxy-Devel-f6753.html">http://www.nabble.com/RtspProxy-Devel-f6753.html</A>
-      &lt;/archive&gt;
-      &lt;subscribe&gt;
-	<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">https://lists.berlios.de/mailman/listinfo/rtspproxy-devel</A>
-      &lt;/subscribe&gt;
-      &lt;unsubscribe&gt;
-	<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">https://lists.berlios.de/mailman/listinfo/rtspproxy-devel</A>
-      &lt;/unsubscribe&gt;
-    &lt;/mailingList&gt;
-  &lt;/mailingLists&gt;
-  
-  &lt;distributionManagement&gt;
-    &lt;downloadUrl&gt;
-      <A HREF="http://rtspproxy.berlios.de/download.html">http://rtspproxy.berlios.de/download.html</A>
-    &lt;/downloadUrl&gt;
-    &lt;site&gt;
-      &lt;id&gt;rtspproxy.website&lt;/id&gt;
-      &lt;name&gt;Default Site&lt;/name&gt;
-      &lt;url&gt;
-	<A HREF="scp://shell.berlios.de/home/groups/rtspproxy/htdocs">scp://shell.berlios.de/home/groups/rtspproxy/htdocs</A>
-      &lt;/url&gt;
-    &lt;/site&gt;
-  &lt;/distributionManagement&gt;
+	&lt;!-- 
+		$Id$
+		$URL$
+	--&gt;
 
-  &lt;modules&gt;
-    &lt;module&gt;RTSPProxy-Core&lt;/module&gt;
-    &lt;module&gt;RTSPProxy-App&lt;/module&gt;
-    &lt;module&gt;RTSPProxy-OSGi&lt;/module&gt;
-    &lt;module&gt;JainSDP&lt;/module&gt;
-  &lt;/modules&gt;
+	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
 
+	&lt;name&gt;RTSP Proxy&lt;/name&gt;
+	&lt;groupId&gt;net.merlimat&lt;/groupId&gt;
+	&lt;artifactId&gt;rtspproxy&lt;/artifactId&gt;
+	&lt;packaging&gt;pom&lt;/packaging&gt;
+	&lt;version&gt;3.0-ALPHA5-SNAPSHOT&lt;/version&gt;
+	&lt;url&gt;<A HREF="http://rtspproxy.berlios.de&lt;/url">http://rtspproxy.berlios.de&lt;/url</A>&gt;
+	&lt;inceptionYear&gt;2003&lt;/inceptionYear&gt;
 
-&lt;dependencies&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;org.apache.directory.mina&lt;/groupId&gt;
-		&lt;artifactId&gt;mina-core&lt;/artifactId&gt;
-		&lt;version&gt;0.9.3&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;organization&gt;
+		&lt;name&gt;Matteo Merli&lt;/name&gt;
+		&lt;url&gt;<A HREF="http://merlimat.net&lt;/url">http://merlimat.net&lt;/url</A>&gt;
+	&lt;/organization&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;mx4j&lt;/groupId&gt;
-		&lt;artifactId&gt;mx4j-tools&lt;/artifactId&gt;
-		&lt;version&gt;2.1.1&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;issueManagement&gt;
+		&lt;system&gt;Berlios&lt;/system&gt;
+		&lt;url&gt;<A HREF="http://developer.berlios.de/bugs/?group_id=4526&lt;/url">http://developer.berlios.de/bugs/?group_id=4526&lt;/url</A>&gt;
+	&lt;/issueManagement&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;org.slf4j&lt;/groupId&gt;
-		&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
-		&lt;version&gt;1.0&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;licenses&gt;
+		&lt;license&gt;
+			&lt;name&gt;GNU General Public License&lt;/name&gt;
+			&lt;url&gt;LICENSE.txt&lt;/url&gt;
+		&lt;/license&gt;
+	&lt;/licenses&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;log4j&lt;/groupId&gt;
-		&lt;artifactId&gt;log4j&lt;/artifactId&gt;
-		&lt;version&gt;1.2.13&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;developers&gt;
+		&lt;developer&gt;
+			&lt;id&gt;merlimat&lt;/id&gt;
+			&lt;name&gt;Matteo Merli&lt;/name&gt;
+			&lt;email&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">matteo.merli at gmail.com</A>&lt;/email&gt;
+			&lt;!-- &lt;timezone&gt;+1&lt;/timezone&gt; --&gt;
+			&lt;url&gt;<A HREF="http://merlimat.net/about&lt;/url">http://merlimat.net/about&lt;/url</A>&gt;
+		&lt;/developer&gt;
+		&lt;developer&gt;
+			&lt;id&gt;rbieniek&lt;/id&gt;
+			&lt;name&gt;Rainer Bieniek&lt;/name&gt;
+			&lt;email&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">Rainer.Bieniek at vodafone.com</A>&lt;/email&gt;
+			&lt;!-- &lt;timezone&gt;+1&lt;/timezone&gt; --&gt;
+		&lt;/developer&gt;
+	&lt;/developers&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;commons-pool&lt;/groupId&gt;
-		&lt;artifactId&gt;commons-pool&lt;/artifactId&gt;
-		&lt;version&gt;1.3&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;scm&gt;
+		&lt;connection&gt;
+			scm:svn:<A HREF="http://svn.berlios.de/svnroot/repos/rtspproxy/trunk">http://svn.berlios.de/svnroot/repos/rtspproxy/trunk</A>
+		&lt;/connection&gt;
+		&lt;developerConnection&gt;
+			scm:svn:<A HREF="https://svn.berlios.de/svnroot/repos/rtspproxy/trunk">https://svn.berlios.de/svnroot/repos/rtspproxy/trunk</A>
+		&lt;/developerConnection&gt;
+		&lt;url&gt;<A HREF="http://svn.berlios.de/wsvn/rtspproxy/&lt;/url">http://svn.berlios.de/wsvn/rtspproxy/&lt;/url</A>&gt;
+	&lt;/scm&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;commons-configuration&lt;/groupId&gt;
-		&lt;artifactId&gt;commons-configuration&lt;/artifactId&gt;
-		&lt;version&gt;1.2&lt;/version&gt;
-	&lt;/dependency&gt;
-	
-	&lt;!-- Included here to disambiguate the version number --&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;commons-collections&lt;/groupId&gt;
-		&lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
-		&lt;version&gt;3.1&lt;/version&gt;
-	&lt;/dependency&gt;
+	&lt;mailingLists&gt;
+		&lt;mailingList&gt;
+			&lt;name&gt;Development list&lt;/name&gt;
+			&lt;post&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">rtspproxy-devel at lists.berlios.de</A>&lt;/post&gt;
 
-	&lt;dependency&gt;
-		&lt;groupId&gt;junit&lt;/groupId&gt;
-		&lt;artifactId&gt;junit&lt;/artifactId&gt;
-		&lt;version&gt;3.8.1&lt;/version&gt;
-		&lt;scope&gt;test&lt;/scope&gt;
-	&lt;/dependency&gt;
+			&lt;archive&gt;<A HREF="http://www.nabble.com/RtspProxy-Devel-f6753.html&lt;/archive">http://www.nabble.com/RtspProxy-Devel-f6753.html&lt;/archive</A>&gt;
+			&lt;subscribe&gt;
+				<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">https://lists.berlios.de/mailman/listinfo/rtspproxy-devel</A>
+			&lt;/subscribe&gt;
+			&lt;unsubscribe&gt;
+				<A HREF="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">https://lists.berlios.de/mailman/listinfo/rtspproxy-devel</A>
+			&lt;/unsubscribe&gt;
+		&lt;/mailingList&gt;
+	&lt;/mailingLists&gt;
 
-	&lt;!-- These are dependencies inherited which are not really
-	     necessaries, so we prevent them from being included
-	     in the final binary package.
-	  --&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;xalan&lt;/groupId&gt;
-		&lt;artifactId&gt;xalan&lt;/artifactId&gt;
-		&lt;version&gt;2.7.0&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-	
-	&lt;dependency&gt;
-		&lt;groupId&gt;xerces&lt;/groupId&gt;
-		&lt;artifactId&gt;xercesImpl&lt;/artifactId&gt;
-		&lt;version&gt;2.2.1&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;xml-apis&lt;/groupId&gt;
-		&lt;artifactId&gt;xml-apis&lt;/artifactId&gt;
-		&lt;version&gt;1.0.b2&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-        &lt;dependency&gt;
-		&lt;groupId&gt;dom4j&lt;/groupId&gt;
-		&lt;artifactId&gt;dom4j&lt;/artifactId&gt;
-		&lt;version&gt;1.4&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;msv&lt;/groupId&gt;
-		&lt;artifactId&gt;msv&lt;/artifactId&gt;
-		&lt;version&gt;20020414&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;javax.servlet&lt;/groupId&gt;
-		&lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
-		&lt;version&gt;2.3&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-	&lt;dependency&gt;
-		&lt;groupId&gt;jaxen&lt;/groupId&gt;
-		&lt;artifactId&gt;jaxen&lt;/artifactId&gt;
-		&lt;version&gt;1.0-FCS&lt;/version&gt;
-		&lt;scope&gt;provided&lt;/scope&gt;
-	&lt;/dependency&gt;
-&lt;/dependencies&gt;
-    
-  &lt;build&gt;
-    &lt;defaultGoal&gt;package&lt;/defaultGoal&gt;
-    
-    &lt;resources&gt;
-      &lt;resource&gt;
-	&lt;directory&gt;src/main/resources&lt;/directory&gt;
-	&lt;filtering&gt;true&lt;/filtering&gt;
-      &lt;/resource&gt;
-    &lt;/resources&gt;
-    
-    &lt;plugins&gt;
-		&lt;plugin&gt;
-			&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-			&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
-			&lt;configuration&gt;
-				&lt;source&gt;1.5&lt;/source&gt;
-				&lt;target&gt;1.5&lt;/target&gt;
-				&lt;optimize&gt;true&lt;/optimize&gt;
-				&lt;debug&gt;true&lt;/debug&gt;
-				&lt;showWarnings&gt;true&lt;/showWarnings&gt;
-				&lt;showDeprecations&gt;true&lt;/showDeprecations&gt;
-			&lt;/configuration&gt;
-		&lt;/plugin&gt;
-	
-&lt;!--
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-	&lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
-	&lt;configuration&gt;
-	  &lt;descriptor&gt;
-	    src/resources/release/default.xml
-	  &lt;/descriptor&gt;
-	&lt;/configuration&gt;
-      &lt;/plugin&gt;
---&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-	&lt;artifactId&gt;maven-site-plugin&lt;/artifactId&gt;
-	&lt;configuration&gt;
-          &lt;addModules&gt;true&lt;/addModules&gt;
-	  &lt;outputEncoding&gt;UTF-8&lt;/outputEncoding&gt;
-	&lt;/configuration&gt;
-	&lt;!--  &lt;version&gt;2.0-beta-2&lt;/version&gt; --&gt;
-      &lt;/plugin&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-	&lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
-	&lt;configuration&gt;
-	  &lt;targetJdk implementation=&quot;java.lang.String&quot;&gt;
-	    1.5
-	  &lt;/targetJdk&gt;
-	&lt;/configuration&gt;
-      &lt;/plugin&gt;
-    &lt;/plugins&gt;
-  &lt;/build&gt;
-  
-  &lt;reporting&gt;
-    &lt;plugins&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-	&lt;artifactId&gt;
-	  maven-project-info-reports-plugin
-	&lt;/artifactId&gt;
-      &lt;/plugin&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
-	&lt;artifactId&gt;changelog-maven-plugin&lt;/artifactId&gt;
-      &lt;/plugin&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
-	&lt;artifactId&gt;surefire-report-maven-plugin&lt;/artifactId&gt;
-      &lt;/plugin&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
-	&lt;artifactId&gt;changes-maven-plugin&lt;/artifactId&gt;
-      &lt;/plugin&gt;
-      &lt;plugin&gt;
-	&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
-	&lt;artifactId&gt;taglist-maven-plugin&lt;/artifactId&gt;
-      &lt;/plugin&gt;
-      &lt;!-- 
-      &lt;plugin&gt;
-      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-      &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
-      &lt;configuration&gt;
-      &lt;charset&gt;UTF-8&lt;/charset&gt;
-      &lt;docencoding&gt;UTF-8&lt;/docencoding&gt;
-      &lt;link&gt;
-      <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/,">http://java.sun.com/j2se/1.5.0/docs/api/,</A>
-      <A HREF="http://www.junit.org/junit/javadoc/3.8.1/,">http://www.junit.org/junit/javadoc/3.8.1/,</A>
-      <A HREF="http://directory.apache.org/subprojects/network/apidocs/">http://directory.apache.org/subprojects/network/apidocs/</A>
-    &lt;/link&gt;
-    &lt;/configuration&gt;
-    &lt;/plugin&gt;
-      --&gt;
-      &lt;!-- 
-      &lt;plugin&gt;
-      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
-      &lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
-      &lt;configuration&gt;
-      &lt;targetJdk implementation=&quot;java.lang.String&quot;&gt;1.5&lt;/targetJdk&gt;
-    &lt;/configuration&gt;
-    &lt;/plugin&gt;
-      --&gt;
-    &lt;/plugins&gt;
-  &lt;/reporting&gt;
+	&lt;distributionManagement&gt;
+		&lt;downloadUrl&gt;<A HREF="http://rtspproxy.berlios.de/download.html&lt;/downloadUrl">http://rtspproxy.berlios.de/download.html&lt;/downloadUrl</A>&gt;
+		&lt;site&gt;
+			&lt;id&gt;rtspproxy.website&lt;/id&gt;
+			&lt;name&gt;Default Site&lt;/name&gt;
+			&lt;url&gt;<A HREF="scp://shell.berlios.de/home/groups/rtspproxy/htdocs&lt;/url">scp://shell.berlios.de/home/groups/rtspproxy/htdocs&lt;/url</A>&gt;
+		&lt;/site&gt;
+	&lt;/distributionManagement&gt;
 
-	&lt;repositories&gt;
+	&lt;modules&gt;
+		&lt;module&gt;RTSPProxy-Core&lt;/module&gt;
+		&lt;module&gt;RTSPProxy-App&lt;/module&gt;
+		&lt;module&gt;RTSPProxy-OSGi&lt;/module&gt;
+		&lt;module&gt;JainSDP&lt;/module&gt;
+	&lt;/modules&gt;
 
-		&lt;repository&gt;
-			&lt;id&gt;Apache repository&lt;/id&gt;
-			&lt;url&gt;<A HREF="http://svn.apache.org/repository/&lt;/url">http://svn.apache.org/repository/&lt;/url</A>&gt;
-		&lt;/repository&gt;
 
-		&lt;!-- For snapshots (no release jars or non-apache jars)           --&gt;
-		&lt;repository&gt;
-			&lt;id&gt;apache.snapshots&lt;/id&gt;
-			&lt;name&gt;Apache Snapshot Repository&lt;/name&gt;
-			&lt;url&gt;<A HREF="http://cvs.apache.org/maven-snapshot-repository&lt;/url">http://cvs.apache.org/maven-snapshot-repository&lt;/url</A>&gt;
-		&lt;/repository&gt;
+	&lt;dependencies&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;org.apache.mina&lt;/groupId&gt;
+			&lt;artifactId&gt;mina-core&lt;/artifactId&gt;
+			&lt;version&gt;1.1.0&lt;/version&gt;
+		&lt;/dependency&gt;
 
-		&lt;!--
-			&lt;repository&gt;
-			&lt;id&gt;ibilio maven2&lt;/id&gt;
-			&lt;url&gt;<A HREF="http://www.ibiblio.org/maven2/&lt;/url">http://www.ibiblio.org/maven2/&lt;/url</A>&gt;
-			&lt;/repository&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;com.google.code.guice&lt;/groupId&gt;
+			&lt;artifactId&gt;guice&lt;/artifactId&gt;
+			&lt;version&gt;1.0&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;mx4j&lt;/groupId&gt;
+			&lt;artifactId&gt;mx4j-tools&lt;/artifactId&gt;
+			&lt;version&gt;2.1.1&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;org.slf4j&lt;/groupId&gt;
+			&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
+			&lt;version&gt;1.3.1&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;commons-pool&lt;/groupId&gt;
+			&lt;artifactId&gt;commons-pool&lt;/artifactId&gt;
+			&lt;version&gt;1.3&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;commons-configuration&lt;/groupId&gt;
+			&lt;artifactId&gt;commons-configuration&lt;/artifactId&gt;
+			&lt;version&gt;1.2&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;!-- Included here to disambiguate the version number --&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;commons-collections&lt;/groupId&gt;
+			&lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
+			&lt;version&gt;3.1&lt;/version&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;org.testng&lt;/groupId&gt;
+			&lt;artifactId&gt;testng&lt;/artifactId&gt;
+			&lt;version&gt;4.7&lt;/version&gt;
+			&lt;classifier&gt;jdk15&lt;/classifier&gt;
+			&lt;scope&gt;test&lt;/scope&gt;
+		&lt;/dependency&gt;
+
+		&lt;dependency&gt;
+			&lt;groupId&gt;org.slf4j&lt;/groupId&gt;
+			&lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
+			&lt;version&gt;1.3.1&lt;/version&gt;
+			&lt;scope&gt;test&lt;/scope&gt;
+		&lt;/dependency&gt;
+
+		&lt;!-- These are dependencies inherited which are not really
+			necessaries, so we prevent them from being included
+			in the final binary package.
 		--&gt;
-	&lt;/repositories&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;xalan&lt;/groupId&gt;
+			&lt;artifactId&gt;xalan&lt;/artifactId&gt;
+			&lt;version&gt;2.7.0&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
 
-  
+		&lt;dependency&gt;
+			&lt;groupId&gt;xerces&lt;/groupId&gt;
+			&lt;artifactId&gt;xercesImpl&lt;/artifactId&gt;
+			&lt;version&gt;2.2.1&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;xml-apis&lt;/groupId&gt;
+			&lt;artifactId&gt;xml-apis&lt;/artifactId&gt;
+			&lt;version&gt;1.0.b2&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;dom4j&lt;/groupId&gt;
+			&lt;artifactId&gt;dom4j&lt;/artifactId&gt;
+			&lt;version&gt;1.4&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;msv&lt;/groupId&gt;
+			&lt;artifactId&gt;msv&lt;/artifactId&gt;
+			&lt;version&gt;20020414&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;javax.servlet&lt;/groupId&gt;
+			&lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
+			&lt;version&gt;2.3&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+		&lt;dependency&gt;
+			&lt;groupId&gt;jaxen&lt;/groupId&gt;
+			&lt;artifactId&gt;jaxen&lt;/artifactId&gt;
+			&lt;version&gt;1.0-FCS&lt;/version&gt;
+			&lt;scope&gt;provided&lt;/scope&gt;
+		&lt;/dependency&gt;
+	&lt;/dependencies&gt;
+
+	&lt;build&gt;
+		&lt;defaultGoal&gt;package&lt;/defaultGoal&gt;
+
+		&lt;resources&gt;
+			&lt;resource&gt;
+				&lt;directory&gt;src/main/resources&lt;/directory&gt;
+				&lt;filtering&gt;true&lt;/filtering&gt;
+			&lt;/resource&gt;
+		&lt;/resources&gt;
+
+		&lt;plugins&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+					&lt;source&gt;1.5&lt;/source&gt;
+					&lt;target&gt;1.5&lt;/target&gt;
+					&lt;optimize&gt;true&lt;/optimize&gt;
+					&lt;debug&gt;true&lt;/debug&gt;
+					&lt;showWarnings&gt;true&lt;/showWarnings&gt;
+					&lt;showDeprecations&gt;true&lt;/showDeprecations&gt;
+				&lt;/configuration&gt;
+			&lt;/plugin&gt;
+
+			&lt;!--
+				&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+				&lt;descriptor&gt;
+				src/resources/release/default.xml
+				&lt;/descriptor&gt;
+				&lt;/configuration&gt;
+				&lt;/plugin&gt;
+			--&gt;
+			&lt;plugin&gt;
+				&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
+				&lt;version&gt;2.4-SNAPSHOT&lt;/version&gt;
+				&lt;configuration&gt;
+					&lt;parallel&gt;true&lt;/parallel&gt;
+					&lt;threadCount&gt;10&lt;/threadCount&gt;
+				&lt;/configuration&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-site-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+					&lt;addModules&gt;false&lt;/addModules&gt;
+					&lt;outputEncoding&gt;UTF-8&lt;/outputEncoding&gt;
+				&lt;/configuration&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+					&lt;targetJdk implementation=&quot;java.lang.String&quot;&gt;1.5&lt;/targetJdk&gt;
+				&lt;/configuration&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-eclipse-plugin&lt;/artifactId&gt;
+			&lt;/plugin&gt;
+		&lt;/plugins&gt;
+	&lt;/build&gt;
+
+	&lt;reporting&gt;
+		&lt;plugins&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-project-info-reports-plugin&lt;/artifactId&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
+				&lt;artifactId&gt;changelog-maven-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+					&lt;basedir&gt;${basedir}&lt;/basedir&gt;
+				&lt;/configuration&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
+				&lt;artifactId&gt;surefire-report-maven-plugin&lt;/artifactId&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
+				&lt;artifactId&gt;changes-maven-plugin&lt;/artifactId&gt;
+			&lt;/plugin&gt;
+			&lt;plugin&gt;
+				&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
+				&lt;artifactId&gt;taglist-maven-plugin&lt;/artifactId&gt;
+			&lt;/plugin&gt;
+			&lt;!-- 
+				&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+				&lt;charset&gt;UTF-8&lt;/charset&gt;
+				&lt;docencoding&gt;UTF-8&lt;/docencoding&gt;
+				&lt;link&gt;
+				<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/,">http://java.sun.com/j2se/1.5.0/docs/api/,</A>
+				<A HREF="http://www.junit.org/junit/javadoc/3.8.1/,">http://www.junit.org/junit/javadoc/3.8.1/,</A>
+				<A HREF="http://directory.apache.org/subprojects/network/apidocs/">http://directory.apache.org/subprojects/network/apidocs/</A>
+				&lt;/link&gt;
+				&lt;/configuration&gt;
+				&lt;/plugin&gt;
+			--&gt;
+			&lt;!-- 
+				&lt;plugin&gt;
+				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
+				&lt;artifactId&gt;maven-pmd-plugin&lt;/artifactId&gt;
+				&lt;configuration&gt;
+				&lt;targetJdk implementation=&quot;java.lang.String&quot;&gt;1.5&lt;/targetJdk&gt;
+				&lt;/configuration&gt;
+				&lt;/plugin&gt;
+			--&gt;
+		&lt;/plugins&gt;
+	&lt;/reporting&gt;
+
+	&lt;pluginRepositories&gt;
+		&lt;pluginRepository&gt;
+			&lt;id&gt;apache.snapshots&lt;/id&gt;
+			&lt;url&gt;<A HREF="http://people.apache.org/repo/m2-snapshot-repository/&lt;/url">http://people.apache.org/repo/m2-snapshot-repository/&lt;/url</A>&gt;
+		&lt;/pluginRepository&gt;
+	&lt;/pluginRepositories&gt;
+
 &lt;/project&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/rtspproxy-devel">More information about the Rtspproxy-devel
mailing list</a><br>
</body></html>
